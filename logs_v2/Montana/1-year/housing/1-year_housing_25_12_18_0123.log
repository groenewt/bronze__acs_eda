2025-12-18 01:23:03 [INFO] census_eda: Logging context set: state=Montana, survey=housing, scope=1-year
2025-12-18 01:23:03 [INFO] census_eda: Log file: ./logs/Montana/1-year/housing/1-year_housing_25_12_18_0123.log
2025-12-18 01:23:03 [INFO] census_eda.main: ======================================================================
2025-12-18 01:23:03 [INFO] census_eda.main: [HOUSING] Processing Montana (1-year)...
2025-12-18 01:23:03 [INFO] census_eda.main: ======================================================================
2025-12-18 01:23:03 [INFO] census_eda.memory: process_Montana_housing_1-year:ENTER: 13899.4MB (delta: -11.9MB)
2025-12-18 01:23:03 [VERBOSE] census_eda.processing.loader: Searching for housing files with scope 1-year...
2025-12-18 01:23:03 [VERBOSE] census_eda.processing.loader: Pattern: /data/temp/census/raw/acs/housing/1-Year/30/*/*.csv
2025-12-18 01:23:03 [VERBOSE] census_eda.processing.loader: Found 16 file(s) to load
2025-12-18 01:23:03 [VERBOSE] census_eda.processing.loader: Loading file 1/16: ss12hmt.csv
2025-12-18 01:23:03 [VERBOSE] census_eda.processing.loader:   Applied 2012 era schema (Housing1Year_2012_2016)
2025-12-18 01:23:03 [VERBOSE] census_eda.processing.loader:   -> Loaded 5,353 rows, 235 columns
2025-12-18 01:23:03 [VERBOSE] census_eda.processing.loader: Loading file 2/16: psam_h30.csv
2025-12-18 01:23:03 [VERBOSE] census_eda.processing.loader:   Applied 2017 era schema (Housing1Year_2017_2022)
2025-12-18 01:23:03 [VERBOSE] census_eda.processing.loader:   -> Loaded 5,572 rows, 235 columns
2025-12-18 01:23:03 [VERBOSE] census_eda.processing.loader: Loading file 3/16: ss14hmt.csv
2025-12-18 01:23:03 [VERBOSE] census_eda.processing.loader:   Applied 2014 era schema (Housing1Year_2012_2016)
2025-12-18 01:23:03 [VERBOSE] census_eda.processing.loader:   -> Loaded 5,342 rows, 235 columns
2025-12-18 01:23:03 [VERBOSE] census_eda.processing.loader: Loading file 4/16: ss13hmt.csv
2025-12-18 01:23:03 [VERBOSE] census_eda.processing.loader:   Applied 2013 era schema (Housing1Year_2012_2016)
2025-12-18 01:23:03 [VERBOSE] census_eda.processing.loader:   -> Loaded 5,329 rows, 235 columns
2025-12-18 01:23:03 [VERBOSE] census_eda.processing.loader: Loading file 5/16: ss07hmt.csv
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader:   Applied 2007 era schema (Housing1Year_2007_2011)
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader:   -> Loaded 4,622 rows, 235 columns
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader: Loading file 6/16: ss09hmt.csv
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader:   Applied 2009 era schema (Housing1Year_2007_2011)
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader:   -> Loaded 4,679 rows, 235 columns
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader: Loading file 7/16: psam_h30.csv
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader:   Applied 2018 era schema (Housing1Year_2017_2022)
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader:   -> Loaded 5,586 rows, 235 columns
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader: Loading file 8/16: ss08hmt.csv
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader:   Applied 2008 era schema (Housing1Year_2007_2011)
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader:   -> Loaded 4,649 rows, 235 columns
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader: Loading file 9/16: ss16hmt.csv
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader:   Applied 2016 era schema (Housing1Year_2012_2016)
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader:   -> Loaded 5,405 rows, 235 columns
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader: Loading file 10/16: psam_h30.csv
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader:   Applied 2019 era schema (Housing1Year_2017_2022)
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader:   -> Loaded 5,646 rows, 235 columns
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader: Loading file 11/16: psam_h30.csv
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader:   Applied 2022 era schema (Housing1Year_2017_2022)
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader:   -> Loaded 5,850 rows, 235 columns
2025-12-18 01:23:04 [VERBOSE] census_eda.processing.loader: Loading file 12/16: psam_h30.csv
2025-12-18 01:23:05 [VERBOSE] census_eda.processing.loader:   Applied 2021 era schema (Housing1Year_2017_2022)
2025-12-18 01:23:05 [VERBOSE] census_eda.processing.loader:   -> Loaded 5,650 rows, 235 columns
2025-12-18 01:23:05 [VERBOSE] census_eda.processing.loader: Loading file 13/16: psam_h30.csv
2025-12-18 01:23:05 [VERBOSE] census_eda.processing.loader:   Applied 2023 era schema (Housing1Year_2023_Plus)
2025-12-18 01:23:05 [VERBOSE] census_eda.processing.loader:   -> Loaded 5,897 rows, 235 columns
2025-12-18 01:23:05 [VERBOSE] census_eda.processing.loader: Loading file 14/16: ss15hmt.csv
2025-12-18 01:23:05 [VERBOSE] census_eda.processing.loader:   Applied 2015 era schema (Housing1Year_2012_2016)
2025-12-18 01:23:05 [VERBOSE] census_eda.processing.loader:   -> Loaded 5,406 rows, 235 columns
2025-12-18 01:23:05 [VERBOSE] census_eda.processing.loader: Loading file 15/16: ss10hmt.csv
2025-12-18 01:23:05 [VERBOSE] census_eda.processing.loader:   Applied 2010 era schema (Housing1Year_2007_2011)
2025-12-18 01:23:05 [VERBOSE] census_eda.processing.loader:   -> Loaded 5,119 rows, 235 columns
2025-12-18 01:23:05 [VERBOSE] census_eda.processing.loader: Loading file 16/16: ss11hmt.csv
2025-12-18 01:23:05 [VERBOSE] census_eda.processing.loader:   Applied 2011 era schema (Housing1Year_2007_2011)
2025-12-18 01:23:05 [VERBOSE] census_eda.processing.loader:   -> Loaded 5,436 rows, 235 columns
2025-12-18 01:23:05 [VERBOSE] census_eda.processing.loader: Successfully loaded 16 dataframe(s)
2025-12-18 01:23:06 [VERBOSE] census_eda.processing.loader: Combined into 85,541 total rows, 235 columns
2025-12-18 01:23:06 [INFO] census_eda.main: Loaded 85,541 records
2025-12-18 01:23:06 [DEBUG] census_eda.main: CENSUS_YEAR_TRACK After schema application: 85541 valid, 16 unique
2025-12-18 01:23:06 [INFO] census_eda.feature_engineering: [FE] Creating all engineered features...
2025-12-18 01:23:06 [DEBUG] census_eda.feature_engineering: Created affordability indices: []
2025-12-18 01:23:06 [DEBUG] census_eda.feature_engineering: Poverty intensity: Skipped for non-population survey
2025-12-18 01:23:06 [DEBUG] census_eda.feature_engineering: Created housing quality index from 3 components
2025-12-18 01:23:06 [DEBUG] census_eda.feature_engineering: Created dependency ratio features
2025-12-18 01:23:06 [DEBUG] census_eda.feature_engineering: Created SNAP eligibility proxy features
2025-12-18 01:23:06 [DEBUG] census_eda.feature_engineering: Created workers ratio features
2025-12-18 01:23:06 [INFO] census_eda.feature_engineering: [FE] Feature engineering complete. Created 14 features.
2025-12-18 01:23:06 [DEBUG] census_eda.main: Feature engineering complete: (85541, 254)
2025-12-18 01:23:07 [DEBUG] census_eda.main: Running comprehensive analysis suite...
2025-12-18 01:23:07 [DEBUG] census_eda.main: Using sample weights from 'Housing_Unit_Weight' column
2025-12-18 01:23:20 [INFO] census_eda.main: [VISUALS] Creating comprehensive visualization suite for HOUSING...
2025-12-18 01:23:20 [VERBOSE] census_eda.visualization.orchestrator: Creating temporal visualizations...
2025-12-18 01:23:20 [VERBOSE] census_eda.visualization.temporal: _plot_sample_counts: df.shape=(85541, 254)
2025-12-18 01:23:20 [VERBOSE] census_eda.visualization.temporal: 'Census_Year' in columns: True
2025-12-18 01:23:20 [VERBOSE] census_eda.visualization.temporal: Census_Year counts: 16 unique years, total records: 85541
2025-12-18 01:23:20 [VERBOSE] census_eda.visualization.temporal: Year range: 2007 to 2023
2025-12-18 01:23:20 [VERBOSE] census_eda.visualization.temporal: _year_distribution: df.shape=(85541, 254)
2025-12-18 01:23:20 [VERBOSE] census_eda.visualization.temporal: Year distribution: {np.int64(2007): np.int64(4622), np.int64(2008): np.int64(4649), np.int64(2009): np.int64(4679), np.int64(2010): np.int64(5119), np.int64(2011): np.int64(5436), np.int64(2012): np.int64(5353), np.int64(2013): np.int64(5329), np.int64(2014): np.int64(5342), np.int64(2015): np.int64(5406), np.int64(2016): np.int64(5405), np.int64(2017): np.int64(5572), np.int64(2018): np.int64(5586), np.int64(2019): np.int64(5646), np.int64(2021): np.int64(5650), np.int64(2022): np.int64(5850), np.int64(2023): np.int64(5897)}
2025-12-18 01:23:21 [VERBOSE] census_eda.visualization.temporal: _temporal_comparison: df.shape=(85541, 254)
2025-12-18 01:23:21 [VERBOSE] census_eda.visualization.temporal: _get_key_numeric_cols: 250 numeric columns total
2025-12-18 01:23:21 [VERBOSE] census_eda.visualization.temporal: Numeric columns: ['Census_Year', 'Census_Division', 'Public_Use_Microdata_Area', 'Census_Region', 'State_Code', 'Housing_Adjustment_Factor', 'Income_Adjustment_Factor', 'Housing_Unit_Weight', 'Number_of_Persons', 'Housing_Unit_Type', 'Number_of_Bedrooms', 'Number_of_Rooms', 'Building_Type', 'Year_Structure_Built', 'Bathtub_or_Shower', 'Refrigerator', 'Hot_and_Cold_Running_Water', 'Running_Water', 'Sink_with_Faucet', 'Stove_or_Range']...
2025-12-18 01:23:21 [VERBOSE] census_eda.visualization.temporal: Matched key columns: ['Number_of_Persons', 'Hot_and_Cold_Running_Water', 'Running_Water', 'Property_Value', 'Electricity_Cost_Monthly', 'Fuel_Cost_Monthly', 'Gas_Cost_Monthly', 'House_Heating_Fuel', 'Insurance_Cost_Yearly', 'Water_Cost_Yearly', 'Mobile_Home_Costs_Monthly', 'First_Mortgage_Includes_Taxes']
2025-12-18 01:23:21 [VERBOSE] census_eda.visualization.temporal: Key numeric columns found: ['Number_of_Persons', 'Hot_and_Cold_Running_Water', 'Running_Water', 'Property_Value', 'Electricity_Cost_Monthly', 'Fuel_Cost_Monthly', 'Gas_Cost_Monthly', 'House_Heating_Fuel', 'Insurance_Cost_Yearly', 'Water_Cost_Yearly', 'Mobile_Home_Costs_Monthly', 'First_Mortgage_Includes_Taxes']
2025-12-18 01:23:21 [VERBOSE] census_eda.visualization.temporal: _plot_metric_trend for column 'Number_of_Persons'
2025-12-18 01:23:21 [VERBOSE] census_eda.visualization.temporal: Column 'Number_of_Persons': 85541 non-null values (zeros excluded if needed)
2025-12-18 01:23:21 [VERBOSE] census_eda.visualization.temporal: Value range: 0.00 to 20.00
2025-12-18 01:23:21 [VERBOSE] census_eda.visualization.temporal: _plot_metric_trend for column 'Hot_and_Cold_Running_Water'
2025-12-18 01:23:21 [VERBOSE] census_eda.visualization.temporal: Column 'Hot_and_Cold_Running_Water': 74396 non-null values (zeros excluded if needed)
2025-12-18 01:23:21 [VERBOSE] census_eda.visualization.temporal: Value range: 1.00 to 2.00
2025-12-18 01:23:21 [VERBOSE] census_eda.visualization.temporal: _plot_metric_trend for column 'Running_Water'
2025-12-18 01:23:21 [VERBOSE] census_eda.visualization.temporal: Column 'Running_Water': 51016 non-null values (zeros excluded if needed)
2025-12-18 01:23:21 [VERBOSE] census_eda.visualization.temporal: Value range: 9.00 to 9.00
2025-12-18 01:23:21 [VERBOSE] census_eda.visualization.temporal: _plot_metric_trend for column 'Property_Value'
2025-12-18 01:23:21 [VERBOSE] census_eda.visualization.temporal: Column 'Property_Value': 38543 non-null values (zeros excluded if needed)
2025-12-18 01:23:21 [VERBOSE] census_eda.visualization.temporal: Value range: 1.00 to 6031000.00
2025-12-18 01:23:23 [VERBOSE] census_eda.visualization.temporal: _plot_metric_trend for column 'Electricity_Cost_Monthly'
2025-12-18 01:23:23 [VERBOSE] census_eda.visualization.temporal: Column 'Electricity_Cost_Monthly': 65382 non-null values (zeros excluded if needed)
2025-12-18 01:23:23 [VERBOSE] census_eda.visualization.temporal: Value range: 1.00 to 2800.00
2025-12-18 01:23:23 [VERBOSE] census_eda.visualization.temporal: _plot_metric_trend for column 'Fuel_Cost_Monthly'
2025-12-18 01:23:23 [VERBOSE] census_eda.visualization.temporal: Column 'Fuel_Cost_Monthly': 47922 non-null values (zeros excluded if needed)
2025-12-18 01:23:23 [VERBOSE] census_eda.visualization.temporal: Value range: 1.00 to 5500.00
2025-12-18 01:23:23 [VERBOSE] census_eda.visualization.temporal: _plot_metric_trend for column 'Gas_Cost_Monthly'
2025-12-18 01:23:23 [VERBOSE] census_eda.visualization.temporal: Column 'Gas_Cost_Monthly': 56816 non-null values (zeros excluded if needed)
2025-12-18 01:23:23 [VERBOSE] census_eda.visualization.temporal: Value range: 1.00 to 2100.00
2025-12-18 01:23:23 [VERBOSE] census_eda.visualization.temporal: _plot_metric_trend for column 'House_Heating_Fuel'
2025-12-18 01:23:23 [VERBOSE] census_eda.visualization.temporal: Column 'House_Heating_Fuel': 66959 non-null values (zeros excluded if needed)
2025-12-18 01:23:23 [VERBOSE] census_eda.visualization.temporal: Value range: 1.00 to 9.00
2025-12-18 01:23:24 [VERBOSE] census_eda.visualization.temporal: _plot_metric_trend for column 'Insurance_Cost_Yearly'
2025-12-18 01:23:24 [VERBOSE] census_eda.visualization.temporal: Column 'Insurance_Cost_Yearly': 41858 non-null values (zeros excluded if needed)
2025-12-18 01:23:24 [VERBOSE] census_eda.visualization.temporal: Value range: 4.00 to 8700.00
2025-12-18 01:23:24 [VERBOSE] census_eda.visualization.temporal: _plot_metric_trend for column 'Water_Cost_Yearly'
2025-12-18 01:23:25 [VERBOSE] census_eda.visualization.temporal: Column 'Water_Cost_Yearly': 54932 non-null values (zeros excluded if needed)
2025-12-18 01:23:25 [VERBOSE] census_eda.visualization.temporal: Value range: 1.00 to 3200.00
2025-12-18 01:23:25 [VERBOSE] census_eda.visualization.temporal: _plot_metric_trend for column 'Mobile_Home_Costs_Monthly'
2025-12-18 01:23:25 [VERBOSE] census_eda.visualization.temporal: Column 'Mobile_Home_Costs_Monthly': 4005 non-null values (zeros excluded if needed)
2025-12-18 01:23:25 [VERBOSE] census_eda.visualization.temporal: Value range: 4.00 to 30900.00
2025-12-18 01:23:25 [VERBOSE] census_eda.visualization.temporal: _plot_metric_trend for column 'First_Mortgage_Includes_Taxes'
2025-12-18 01:23:25 [VERBOSE] census_eda.visualization.temporal: Column 'First_Mortgage_Includes_Taxes': 24965 non-null values (zeros excluded if needed)
2025-12-18 01:23:25 [VERBOSE] census_eda.visualization.temporal: Value range: 1.00 to 2.00
2025-12-18 01:23:27 [VERBOSE] census_eda.visualization.orchestrator: Creating economic visualizations...
2025-12-18 01:23:40 [VERBOSE] census_eda.visualization.orchestrator: Creating correlation visualizations...
2025-12-18 01:23:40 [VERBOSE] census_eda.visualization.correlation: Creating correlation heatmap...
2025-12-18 01:23:41 [VERBOSE] census_eda.visualization.correlation: Creating heatmap with 10 columns
2025-12-18 01:23:41 [VERBOSE] census_eda.visualization.correlation: Creating scatter matrix...
2025-12-18 01:23:41 [DEBUG] census_eda.memory: Skipping sampling: 38498MB available (>16GB)
2025-12-18 01:23:41 [VERBOSE] census_eda.visualization.correlation: Creating scatter matrix with 8 columns, 85541 rows
2025-12-18 01:23:54 [VERBOSE] census_eda.visualization.orchestrator: Creating statistical distribution visualizations...
2025-12-18 01:23:54 [VERBOSE] census_eda.visualization.statistical: _box_plots: df.shape=(85541, 254)
2025-12-18 01:23:54 [INFO] census_eda.visualization.statistical: [MEMORY] Housing: 16/250 columns (excluded flags/binary)
2025-12-18 01:23:54 [VERBOSE] census_eda.visualization.statistical: Key columns for box plots: ['Number_of_Persons', 'Number_of_Bedrooms', 'Number_of_Rooms', 'Hot_and_Cold_Running_Water', 'Running_Water', 'Property_Value', 'Vehicles_Available', 'Condo_Fee_Monthly', 'Electricity_Cost_Monthly', 'Fuel_Cost_Monthly', 'Gas_Cost_Monthly', 'House_Heating_Fuel', 'Insurance_Cost_Yearly', 'Water_Cost_Yearly', 'Mobile_Home_Costs_Monthly', 'First_Mortgage_Includes_Insurance']
2025-12-18 01:23:54 [VERBOSE] census_eda.visualization.statistical: Box plot for 'Number_of_Persons': 85541 non-null values
2025-12-18 01:23:54 [VERBOSE] census_eda.visualization.statistical: Data range: 0.00 to 20.00
2025-12-18 01:23:54 [VERBOSE] census_eda.visualization.statistical: Box plot for 'Number_of_Bedrooms': 60234 non-null values
2025-12-18 01:23:54 [VERBOSE] census_eda.visualization.statistical: Data range: 0.00 to 10.00
2025-12-18 01:23:54 [VERBOSE] census_eda.visualization.statistical: Box plot for 'Number_of_Rooms': 60234 non-null values
2025-12-18 01:23:54 [VERBOSE] census_eda.visualization.statistical: Data range: 1.00 to 21.00
2025-12-18 01:23:54 [VERBOSE] census_eda.visualization.statistical: Box plot for 'Hot_and_Cold_Running_Water': 74396 non-null values
2025-12-18 01:23:54 [VERBOSE] census_eda.visualization.statistical: Data range: 1.00 to 2.00
2025-12-18 01:23:55 [VERBOSE] census_eda.visualization.statistical: Box plot for 'Running_Water': 51016 non-null values
2025-12-18 01:23:55 [VERBOSE] census_eda.visualization.statistical: Data range: 9.00 to 9.00
2025-12-18 01:23:55 [VERBOSE] census_eda.visualization.statistical: Box plot for 'Property_Value': 38543 non-null values
2025-12-18 01:23:55 [VERBOSE] census_eda.visualization.statistical: Data range: 1.00 to 6031000.00
2025-12-18 01:23:55 [VERBOSE] census_eda.visualization.statistical: Box plot for 'Vehicles_Available': 66959 non-null values
2025-12-18 01:23:55 [VERBOSE] census_eda.visualization.statistical: Data range: 0.00 to 6.00
2025-12-18 01:23:55 [VERBOSE] census_eda.visualization.statistical: Box plot for 'Condo_Fee_Monthly': 895 non-null values
2025-12-18 01:23:55 [VERBOSE] census_eda.visualization.statistical: Data range: 4.00 to 3200.00
2025-12-18 01:23:57 [VERBOSE] census_eda.visualization.statistical: Box plot for 'Electricity_Cost_Monthly': 65382 non-null values
2025-12-18 01:23:57 [VERBOSE] census_eda.visualization.statistical: Data range: 1.00 to 2800.00
2025-12-18 01:23:57 [VERBOSE] census_eda.visualization.statistical: Box plot for 'Fuel_Cost_Monthly': 47922 non-null values
2025-12-18 01:23:57 [VERBOSE] census_eda.visualization.statistical: Data range: 1.00 to 5500.00
2025-12-18 01:23:57 [VERBOSE] census_eda.visualization.statistical: Box plot for 'Gas_Cost_Monthly': 56816 non-null values
2025-12-18 01:23:57 [VERBOSE] census_eda.visualization.statistical: Data range: 1.00 to 2100.00
2025-12-18 01:23:57 [VERBOSE] census_eda.visualization.statistical: Box plot for 'House_Heating_Fuel': 66959 non-null values
2025-12-18 01:23:57 [VERBOSE] census_eda.visualization.statistical: Data range: 1.00 to 9.00
2025-12-18 01:23:58 [VERBOSE] census_eda.visualization.statistical: Box plot for 'Insurance_Cost_Yearly': 41858 non-null values
2025-12-18 01:23:58 [VERBOSE] census_eda.visualization.statistical: Data range: 4.00 to 8700.00
2025-12-18 01:23:58 [VERBOSE] census_eda.visualization.statistical: Box plot for 'Water_Cost_Yearly': 54932 non-null values
2025-12-18 01:23:58 [VERBOSE] census_eda.visualization.statistical: Data range: 1.00 to 3200.00
2025-12-18 01:23:58 [VERBOSE] census_eda.visualization.statistical: Box plot for 'Mobile_Home_Costs_Monthly': 4005 non-null values
2025-12-18 01:23:58 [VERBOSE] census_eda.visualization.statistical: Data range: 4.00 to 30900.00
2025-12-18 01:23:58 [VERBOSE] census_eda.visualization.statistical: Box plot for 'First_Mortgage_Includes_Insurance': 24965 non-null values
2025-12-18 01:23:58 [VERBOSE] census_eda.visualization.statistical: Data range: 1.00 to 2.00
2025-12-18 01:24:00 [INFO] census_eda.visualization.statistical: [MEMORY] Housing: 16/250 columns (excluded flags/binary)
2025-12-18 01:24:07 [VERBOSE] census_eda.visualization.orchestrator: Creating advanced visualizations (violin, ridge, radar)...
2025-12-18 01:24:14 [VERBOSE] census_eda.visualization.orchestrator: Creating year-over-year change visualizations...
2025-12-18 01:24:21 [VERBOSE] census_eda.visualization.orchestrator: Creating outlier and anomaly detection visualizations...
2025-12-18 01:24:33 [VERBOSE] census_eda.visualization.orchestrator: Creating housing characteristics visualizations...
2025-12-18 01:24:33 [VERBOSE] census_eda.visualization.housing: Creating housing characteristics visualizations...
2025-12-18 01:24:33 [VERBOSE] census_eda.visualization.housing: Creating bedrooms/rooms distribution visualization...
2025-12-18 01:24:34 [VERBOSE] census_eda.visualization.housing: Creating building type trends visualization...
2025-12-18 01:24:34 [VERBOSE] census_eda.visualization.housing: Creating year built distribution visualization...
2025-12-18 01:24:35 [VERBOSE] census_eda.visualization.housing: Creating vehicles available visualization...
2025-12-18 01:24:36 [VERBOSE] census_eda.visualization.orchestrator: Creating household composition visualizations...
2025-12-18 01:24:36 [VERBOSE] census_eda.visualization.housing: Creating household composition visualizations...
2025-12-18 01:24:36 [VERBOSE] census_eda.visualization.housing: Creating family type distribution visualization...
2025-12-18 01:24:37 [VERBOSE] census_eda.visualization.housing: Creating household size visualization...
2025-12-18 01:24:38 [VERBOSE] census_eda.visualization.housing: Creating children presence visualization...
2025-12-18 01:24:38 [VERBOSE] census_eda.visualization.housing: Creating multigenerational trends visualization...
2025-12-18 01:24:39 [VERBOSE] census_eda.visualization.housing: Creating household age composition visualization...
2025-12-18 01:24:40 [VERBOSE] census_eda.visualization.housing: Creating SNAP participation visualization...
2025-12-18 01:24:41 [VERBOSE] census_eda.visualization.housing: Creating workers distribution visualization...
2025-12-18 01:24:41 [VERBOSE] census_eda.visualization.housing: Creating household diversity visualization...
2025-12-18 01:24:43 [VERBOSE] census_eda.visualization.orchestrator: Creating cost burden visualizations...
2025-12-18 01:24:43 [VERBOSE] census_eda.visualization.housing: Creating cost burden visualizations...
2025-12-18 01:24:43 [VERBOSE] census_eda.visualization.housing: Creating rent burden visualization...
2025-12-18 01:24:44 [VERBOSE] census_eda.visualization.housing: Creating owner cost burden visualization...
2025-12-18 01:24:44 [VERBOSE] census_eda.visualization.housing: Creating utility costs comparison visualization...
2025-12-18 01:24:45 [VERBOSE] census_eda.visualization.housing: Creating affordability ECDF visualization...
2025-12-18 01:24:46 [VERBOSE] census_eda.visualization.housing: Creating burden concentration visualization...
2025-12-18 01:24:47 [VERBOSE] census_eda.visualization.housing: Creating burden by demographic visualization...
2025-12-18 01:24:48 [VERBOSE] census_eda.visualization.orchestrator: Creating technology adoption visualizations...
2025-12-18 01:24:48 [VERBOSE] census_eda.visualization.technology: Creating technology adoption visualizations...
2025-12-18 01:24:48 [VERBOSE] census_eda.visualization.technology: Creating technology adoption trends for 3 tech columns...
2025-12-18 01:24:49 [VERBOSE] census_eda.visualization.technology: Creating device ownership pie charts for 2 devices...
2025-12-18 01:24:50 [VERBOSE] census_eda.visualization.orchestrator: Creating multi-variable interaction visualizations...
2025-12-18 01:24:50 [DEBUG] census_eda.memory: Skipping sampling: 38453MB available (>16GB)
2025-12-18 01:24:54 [VERBOSE] census_eda.visualization.orchestrator: Creating distribution comparison visualizations...
2025-12-18 01:24:54 [DEBUG] census_eda.memory: Skipping sampling: 38428MB available (>16GB)
2025-12-18 01:24:59 [VERBOSE] census_eda.visualization.orchestrator: Creating enhanced feature interaction visualizations...
2025-12-18 01:24:59 [DEBUG] census_eda.memory: Skipping sampling: 38452MB available (>16GB)
2025-12-18 01:25:02 [VERBOSE] census_eda.visualization.orchestrator: Creating inequality visualizations...
2025-12-18 01:25:07 [VERBOSE] census_eda.visualization.orchestrator: All visualizations complete!
2025-12-18 01:25:07 [VERBOSE] census_eda.visualization.orchestrator: Creating missing data analysis...
2025-12-18 01:25:08 [INFO] census_eda.main: SUCCESS: Visualizations saved to ./output/Montana/housing/1-year/figures
2025-12-18 01:25:09 [DEBUG] census_eda.memory: Skipping sampling: 38443MB available (>16GB)
2025-12-18 01:25:09 [INFO] census_eda.main: [ML] Running ML pipeline for HOUSING...
2025-12-18 01:25:09 [INFO] census_eda.main: [ML] Hyperparameter tuning ENABLED (this may take longer)
2025-12-18 01:25:09 [INFO] census_eda.memory: [ML-START]: 13924.1MB (delta: +24.6MB)
2025-12-18 01:25:09 [INFO] census_eda.main: [ML] Starting regression training...
2025-12-18 01:25:09 [INFO] census_eda.main: [ML] Training regression models for target: Property_Value
2025-12-18 01:25:09 [DEBUG] census_eda.main: [REGRESSION] Property_Value: After zero-filter on target: 28779 samples (was 28779)
2025-12-18 01:25:09 [DEBUG] census_eda.main: [ML] Using sample weights from 'Housing_Unit_Weight'
2025-12-18 01:25:09 [INFO] census_eda.ml.comparison: [TUNE] Tuning hyperparameters for ridge...
2025-12-18 01:25:09 [INFO] census_eda.ml.regression: [TUNE] Data: 28,779 samples, 10 features
2025-12-18 01:25:09 [INFO] census_eda.ml.regression: [TUNE] Searching 5 combinations (5-fold CV = 25 fits)
2025-12-18 01:25:09 [INFO] census_eda.memory: tune_ridge:ENTER: 13924.1MB (delta: +0.0MB)
2025-12-18 01:25:10 [INFO] census_eda.memory: tune_ridge:EXIT: 13924.8MB (delta: +0.8MB)
2025-12-18 01:25:10 [INFO] census_eda.ml.comparison: [TUNE] Best params for ridge: {'alpha': 100.0}
2025-12-18 01:25:10 [INFO] census_eda.ml.comparison: [TUNE] Best CV R² score: 0.0582
2025-12-18 01:25:10 [INFO] census_eda.ml.comparison: [TUNE] Searched 5 parameter combinations
2025-12-18 01:25:10 [INFO] census_eda.ml.comparison: [TUNE] Tuning hyperparameters for lasso...
2025-12-18 01:25:10 [INFO] census_eda.ml.regression: [TUNE] Data: 28,779 samples, 10 features
2025-12-18 01:25:10 [INFO] census_eda.ml.regression: [TUNE] Searching 5 combinations (5-fold CV = 25 fits)
2025-12-18 01:25:10 [INFO] census_eda.memory: tune_lasso:ENTER: 13924.8MB (delta: +0.0MB)
2025-12-18 01:25:11 [INFO] census_eda.memory: tune_lasso:EXIT: 13924.9MB (delta: +0.0MB)
2025-12-18 01:25:11 [INFO] census_eda.ml.comparison: [TUNE] Best params for lasso: {'alpha': 100.0}
2025-12-18 01:25:11 [INFO] census_eda.ml.comparison: [TUNE] Best CV R² score: 0.0582
2025-12-18 01:25:11 [INFO] census_eda.ml.comparison: [TUNE] Searched 5 parameter combinations
2025-12-18 01:25:11 [INFO] census_eda.ml.comparison: [TUNE] Tuning hyperparameters for random_forest...
2025-12-18 01:25:11 [INFO] census_eda.memory: [ML-TUNE] Limiting samples: 28,779 -> 25,000 (120 total fits from 24 combos × 5 folds)
2025-12-18 01:25:11 [INFO] census_eda.ml.regression: [TUNE] Data: 25,000 samples, 10 features
2025-12-18 01:25:11 [INFO] census_eda.ml.regression: [TUNE] Searching 24 combinations (5-fold CV = 120 fits)
2025-12-18 01:25:11 [INFO] census_eda.memory: tune_random_forest:ENTER: 13924.9MB (delta: +0.0MB)
2025-12-18 01:25:37 [INFO] census_eda.memory: tune_random_forest:EXIT: 13928.4MB (delta: +3.6MB)
2025-12-18 01:25:37 [INFO] census_eda.ml.comparison: [TUNE] Best params for random_forest: {'max_depth': 20, 'min_samples_leaf': 2, 'min_samples_split': 5, 'n_estimators': 200}
2025-12-18 01:25:37 [INFO] census_eda.ml.comparison: [TUNE] Best CV R² score: 0.0732
2025-12-18 01:25:37 [INFO] census_eda.ml.comparison: [TUNE] Searched 24 parameter combinations
2025-12-18 01:25:40 [INFO] census_eda.ml.comparison: [TUNE] Tuning hyperparameters for gradient_boosting...
2025-12-18 01:25:40 [INFO] census_eda.memory: [ML-TUNE] Limiting samples: 28,779 -> 25,000 (120 total fits from 24 combos × 5 folds)
2025-12-18 01:25:40 [INFO] census_eda.ml.regression: [TUNE] Data: 25,000 samples, 10 features
2025-12-18 01:25:40 [INFO] census_eda.ml.regression: [TUNE] Searching 24 combinations (5-fold CV = 120 fits)
2025-12-18 01:25:40 [INFO] census_eda.memory: tune_gradient_boosting:ENTER: 13933.4MB (delta: +5.0MB)
2025-12-18 01:25:54 [INFO] census_eda.memory: tune_gradient_boosting:EXIT: 13933.4MB (delta: +0.0MB)
2025-12-18 01:25:54 [INFO] census_eda.ml.comparison: [TUNE] Best params for gradient_boosting: {'learning_rate': 0.1, 'max_depth': 5, 'n_estimators': 100, 'subsample': 1.0}
2025-12-18 01:25:54 [INFO] census_eda.ml.comparison: [TUNE] Best CV R² score: 0.1278
2025-12-18 01:25:54 [INFO] census_eda.ml.comparison: [TUNE] Searched 24 parameter combinations
2025-12-18 01:26:00 [INFO] census_eda.memory: [SHAP] Safe sample size: 5,756 -> 1,000
2025-12-18 01:26:00 [INFO] census_eda.ml.explainability: [SHAP] Sampled test data: 5,756 -> 1,000
2025-12-18 01:26:00 [INFO] census_eda.memory: SHAP_TreeExplainer:ENTER: 13933.4MB (delta: +0.0MB)
2025-12-18 01:26:00 [INFO] census_eda.ml.explainability: [SHAP] Computing TreeExplainer for 1,000 samples...
2025-12-18 01:26:01 [INFO] census_eda.memory: SHAP_TreeExplainer:EXIT: 13933.4MB (delta: +0.0MB)
2025-12-18 01:26:01 [INFO] census_eda.ml.explainability: [SHAP] TreeExplainer complete. Top feature: Year_Structure_Built
2025-12-18 01:26:01 [INFO] census_eda.main: [SHAP] Generated explanation for gradient_boosting
2025-12-18 01:26:01 [INFO] census_eda.main: [ML] Training regression models for target: Gross_Rent
2025-12-18 01:26:01 [DEBUG] census_eda.main: [REGRESSION] Gross_Rent: After zero-filter on target: 8415 samples (was 8415)
2025-12-18 01:26:01 [DEBUG] census_eda.main: [ML] Using sample weights from 'Housing_Unit_Weight'
2025-12-18 01:26:01 [INFO] census_eda.ml.comparison: [TUNE] Tuning hyperparameters for ridge...
2025-12-18 01:26:01 [INFO] census_eda.ml.regression: [TUNE] Data: 8,415 samples, 10 features
2025-12-18 01:26:01 [INFO] census_eda.ml.regression: [TUNE] Searching 5 combinations (5-fold CV = 25 fits)
2025-12-18 01:26:01 [INFO] census_eda.memory: tune_ridge:ENTER: 13933.4MB (delta: +0.0MB)
2025-12-18 01:26:02 [INFO] census_eda.memory: tune_ridge:EXIT: 13933.5MB (delta: +0.0MB)
2025-12-18 01:26:02 [INFO] census_eda.ml.comparison: [TUNE] Best params for ridge: {'alpha': 100.0}
2025-12-18 01:26:02 [INFO] census_eda.ml.comparison: [TUNE] Best CV R² score: 0.1349
2025-12-18 01:26:02 [INFO] census_eda.ml.comparison: [TUNE] Searched 5 parameter combinations
2025-12-18 01:26:02 [INFO] census_eda.ml.comparison: [TUNE] Tuning hyperparameters for lasso...
2025-12-18 01:26:02 [INFO] census_eda.ml.regression: [TUNE] Data: 8,415 samples, 10 features
2025-12-18 01:26:02 [INFO] census_eda.ml.regression: [TUNE] Searching 5 combinations (5-fold CV = 25 fits)
2025-12-18 01:26:02 [INFO] census_eda.memory: tune_lasso:ENTER: 13933.5MB (delta: +0.0MB)
2025-12-18 01:26:02 [INFO] census_eda.memory: tune_lasso:EXIT: 13933.5MB (delta: +0.0MB)
2025-12-18 01:26:02 [INFO] census_eda.ml.comparison: [TUNE] Best params for lasso: {'alpha': 1.0}
2025-12-18 01:26:02 [INFO] census_eda.ml.comparison: [TUNE] Best CV R² score: 0.1348
2025-12-18 01:26:02 [INFO] census_eda.ml.comparison: [TUNE] Searched 5 parameter combinations
2025-12-18 01:26:02 [INFO] census_eda.ml.comparison: [TUNE] Tuning hyperparameters for random_forest...
2025-12-18 01:26:02 [INFO] census_eda.ml.regression: [TUNE] Data: 8,415 samples, 10 features
2025-12-18 01:26:02 [INFO] census_eda.ml.regression: [TUNE] Searching 24 combinations (5-fold CV = 120 fits)
2025-12-18 01:26:02 [INFO] census_eda.memory: tune_random_forest:ENTER: 13933.5MB (delta: +0.0MB)
2025-12-18 01:26:12 [INFO] census_eda.memory: tune_random_forest:EXIT: 13933.5MB (delta: +0.0MB)
2025-12-18 01:26:12 [INFO] census_eda.ml.comparison: [TUNE] Best params for random_forest: {'max_depth': 20, 'min_samples_leaf': 2, 'min_samples_split': 5, 'n_estimators': 200}
2025-12-18 01:26:12 [INFO] census_eda.ml.comparison: [TUNE] Best CV R² score: 0.1840
2025-12-18 01:26:12 [INFO] census_eda.ml.comparison: [TUNE] Searched 24 parameter combinations
2025-12-18 01:26:14 [INFO] census_eda.ml.comparison: [TUNE] Tuning hyperparameters for gradient_boosting...
2025-12-18 01:26:14 [INFO] census_eda.ml.regression: [TUNE] Data: 8,415 samples, 10 features
2025-12-18 01:26:14 [INFO] census_eda.ml.regression: [TUNE] Searching 24 combinations (5-fold CV = 120 fits)
2025-12-18 01:26:14 [INFO] census_eda.memory: tune_gradient_boosting:ENTER: 13933.5MB (delta: +0.0MB)
2025-12-18 01:26:19 [INFO] census_eda.memory: tune_gradient_boosting:EXIT: 13933.5MB (delta: +0.0MB)
2025-12-18 01:26:19 [INFO] census_eda.ml.comparison: [TUNE] Best params for gradient_boosting: {'learning_rate': 0.1, 'max_depth': 5, 'n_estimators': 100, 'subsample': 0.8}
2025-12-18 01:26:19 [INFO] census_eda.ml.comparison: [TUNE] Best CV R² score: 0.2202
2025-12-18 01:26:19 [INFO] census_eda.ml.comparison: [TUNE] Searched 24 parameter combinations
2025-12-18 01:26:21 [INFO] census_eda.memory: [SHAP] Safe sample size: 1,683 -> 1,000
2025-12-18 01:26:21 [INFO] census_eda.ml.explainability: [SHAP] Sampled test data: 1,683 -> 1,000
2025-12-18 01:26:21 [INFO] census_eda.memory: SHAP_TreeExplainer:ENTER: 13933.5MB (delta: +0.0MB)
2025-12-18 01:26:21 [INFO] census_eda.ml.explainability: [SHAP] Computing TreeExplainer for 1,000 samples...
2025-12-18 01:26:22 [INFO] census_eda.memory: SHAP_TreeExplainer:EXIT: 13933.5MB (delta: +0.0MB)
2025-12-18 01:26:22 [INFO] census_eda.ml.explainability: [SHAP] TreeExplainer complete. Top feature: Year_Structure_Built
2025-12-18 01:26:22 [INFO] census_eda.main: [SHAP] Generated explanation for gradient_boosting
2025-12-18 01:26:22 [INFO] census_eda.main: [ML] Regression complete. 2 models trained.
2025-12-18 01:26:22 [INFO] census_eda.memory: [PRE-CLUSTERING]: 13933.5MB (delta: +0.0MB)
2025-12-18 01:26:22 [INFO] census_eda.main: [CLUSTERING] Starting clustering model training...
2025-12-18 01:26:22 [INFO] census_eda.main: [CLUSTERING] KMeans on 45,367 samples...
2025-12-18 01:26:33 [INFO] census_eda.main: [CLUSTERING] KMeans complete.
2025-12-18 01:26:33 [INFO] census_eda.main: [CLUSTERING] Hierarchical on 45,367 samples (will sample if needed)...
2025-12-18 01:26:33 [INFO] census_eda.memory: [MEMORY] O(n²) safe sample: 45,367 -> 15,000 (distance matrix would be 15.3GB)
2025-12-18 01:26:33 [INFO] census_eda.ml.clustering: [HIERARCHICAL] Sampled 45,367 -> 15,000 for O(n²) distance matrix
2025-12-18 01:26:37 [INFO] census_eda.main: [CLUSTERING] Hierarchical complete.
2025-12-18 01:26:37 [INFO] census_eda.main: [CLUSTERING] Clustering complete.
2025-12-18 01:26:37 [INFO] census_eda.main: [ML] Starting time series training...
2025-12-18 01:26:37 [INFO] census_eda.main: [ML-TIMESERIES] Training time series for 2 targets: ['Property_Value', 'Gross_Rent']
2025-12-18 01:26:37 [INFO] census_eda.main: [ML-TIMESERIES] Training time series for target: Property_Value
2025-12-18 01:26:37 [DEBUG] census_eda.main: [DEBUG-TS] Target: Property_Value, Forecasts: {2024: 576122.5361328125, 2025: 669012.98828125, 2026: 780287.4921875}, Values: [576122.5361328125, 669012.98828125, 780287.4921875]
2025-12-18 01:26:37 [INFO] census_eda.main: [ML-TIMESERIES] Training time series for target: Gross_Rent
2025-12-18 01:26:37 [DEBUG] census_eda.main: [DEBUG-TS] Target: Gross_Rent, Forecasts: {2024: 1236.6635591983795, 2025: 1351.5502216815948, 2026: 1483.5611078739166}, Values: [1236.6635591983795, 1351.5502216815948, 1483.5611078739166]
2025-12-18 01:26:37 [INFO] census_eda.main: [ML] All ML models complete. Total: 5 result keys.
2025-12-18 01:26:43 [INFO] census_eda.main: [SHAP-VIZ] Creating SHAP visualizations for Property_Value
2025-12-18 01:26:48 [INFO] census_eda.main: [SHAP-VIZ] Creating SHAP visualizations for Gross_Rent
2025-12-18 01:26:50 [WARNING] census_eda.main:  Clustering viz failed for hierarchical: 'c' argument has 15000 elements, which is inconsistent with 'x' and 'y' with size 45367.
2025-12-18 01:26:50 [DEBUG] census_eda.main: [VIZ-TIMESERIES] Found 2 time series results: ['Property_Value_timeseries', 'Gross_Rent_timeseries']
2025-12-18 01:26:50 [DEBUG] census_eda.main: [VIZ-TIMESERIES] Visualizing time series for target: Property_Value
2025-12-18 01:26:50 [DEBUG] census_eda.main: [DEBUG-TS-MODEL] polynomial_degree_1: forecasts={2024: 488356.2342104167, 2025: 514668.41657683253, 2026: 540980.5989432409}, values=[488356.2342104167, 514668.41657683253, 540980.5989432409], CI_lower=[426321.8633903733, 452634.04575678916, 478946.22812319756], CI_upper=[550390.60503046, 576702.7873968759, 603014.9697632843]
2025-12-18 01:26:50 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Forecast values: [488356.2342104167, 514668.41657683253, 540980.5989432409], CI_lower: [426321.8633903733, 452634.04575678916, 478946.22812319756], CI_upper: [550390.60503046, 576702.7873968759, 603014.9697632843]
2025-12-18 01:26:50 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Plotted CI bands: lower=[np.float64(476363.18257032544), 426321.8633903733, 452634.04575678916, 478946.22812319756], upper=[np.float64(476363.18257032544), 550390.60503046, 576702.7873968759, 603014.9697632843]
2025-12-18 01:26:51 [DEBUG] census_eda.main: [DEBUG-TS-MODEL] polynomial_degree_2: forecasts={2024: 480462.1816829443, 2025: 504013.81431150436, 2026: 527256.805133462}, values=[480462.1816829443, 504013.81431150436, 527256.805133462], CI_lower=[418831.56325969985, 442383.1958882599, 465626.1867102175], CI_upper=[542092.8001061887, 565644.4327347488, 588887.4235567064]
2025-12-18 01:26:51 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Forecast values: [480462.1816829443, 504013.81431150436, 527256.805133462], CI_lower: [418831.56325969985, 442383.1958882599, 465626.1867102175], CI_upper: [542092.8001061887, 565644.4327347488, 588887.4235567064]
2025-12-18 01:26:51 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Plotted CI bands: lower=[np.float64(476363.18257032544), 418831.56325969985, 442383.1958882599, 465626.1867102175], upper=[np.float64(476363.18257032544), 542092.8001061887, 565644.4327347488, 588887.4235567064]
2025-12-18 01:26:51 [DEBUG] census_eda.main: [DEBUG-TS-MODEL] polynomial_degree_3: forecasts={2024: 576122.5361328125, 2025: 669012.98828125, 2026: 780287.4921875}, values=[576122.5361328125, 669012.98828125, 780287.4921875], CI_lower=[548511.610558553, 641402.0627069905, 752676.5666132405], CI_upper=[603733.461707072, 696623.9138555095, 807898.4177617595]
2025-12-18 01:26:51 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Forecast values: [576122.5361328125, 669012.98828125, 780287.4921875], CI_lower: [548511.610558553, 641402.0627069905, 752676.5666132405], CI_upper: [603733.461707072, 696623.9138555095, 807898.4177617595]
2025-12-18 01:26:51 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Plotted CI bands: lower=[np.float64(476363.18257032544), 548511.610558553, 641402.0627069905, 752676.5666132405], upper=[np.float64(476363.18257032544), 603733.461707072, 696623.9138555095, 807898.4177617595]
2025-12-18 01:26:52 [DEBUG] census_eda.main: [DEBUG-TS-MODEL] sma: forecasts={2024: 449720.21244616434, 2025: 449720.21244616434, 2026: 449720.21244616434}, values=[449720.21244616434, 449720.21244616434, 449720.21244616434], CI_lower=[332246.5537768865, 332246.5537768865, 332246.5537768865], CI_upper=[567193.8711154421, 567193.8711154421, 567193.8711154421]
2025-12-18 01:26:52 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Forecast values: [449720.21244616434, 449720.21244616434, 449720.21244616434], CI_lower: [332246.5537768865, 332246.5537768865, 332246.5537768865], CI_upper: [567193.8711154421, 567193.8711154421, 567193.8711154421]
2025-12-18 01:26:52 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Plotted CI bands: lower=[np.float64(476363.18257032544), 332246.5537768865, 332246.5537768865, 332246.5537768865], upper=[np.float64(476363.18257032544), 567193.8711154421, 567193.8711154421, 567193.8711154421]
2025-12-18 01:26:53 [DEBUG] census_eda.main: [DEBUG-TS-MODEL] ewma: forecasts={2024: 391667.18358862144, 2025: 391667.18358862144, 2026: 391667.18358862144}, values=[391667.18358862144, 391667.18358862144, 391667.18358862144], CI_lower=[311804.14120081573, 311804.14120081573, 311804.14120081573], CI_upper=[471530.22597642714, 471530.22597642714, 471530.22597642714]
2025-12-18 01:26:53 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Forecast values: [391667.18358862144, 391667.18358862144, 391667.18358862144], CI_lower: [311804.14120081573, 311804.14120081573, 311804.14120081573], CI_upper: [471530.22597642714, 471530.22597642714, 471530.22597642714]
2025-12-18 01:26:53 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Plotted CI bands: lower=[np.float64(476363.18257032544), 311804.14120081573, 311804.14120081573, 311804.14120081573], upper=[np.float64(476363.18257032544), 471530.22597642714, 471530.22597642714, 471530.22597642714]
2025-12-18 01:26:53 [DEBUG] census_eda.main: [DEBUG-TS-MODEL] wma: forecasts={2024: 459502.2272109489, 2025: 459502.2272109489, 2026: 459502.2272109489}, values=[459502.2272109489, 459502.2272109489, 459502.2272109489], CI_lower=[338041.0783701083, 338041.0783701083, 338041.0783701083], CI_upper=[580963.3760517895, 580963.3760517895, 580963.3760517895]
2025-12-18 01:26:53 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Forecast values: [459502.2272109489, 459502.2272109489, 459502.2272109489], CI_lower: [338041.0783701083, 338041.0783701083, 338041.0783701083], CI_upper: [580963.3760517895, 580963.3760517895, 580963.3760517895]
2025-12-18 01:26:53 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Plotted CI bands: lower=[np.float64(476363.18257032544), 338041.0783701083, 338041.0783701083, 338041.0783701083], upper=[np.float64(476363.18257032544), 580963.3760517895, 580963.3760517895, 580963.3760517895]
2025-12-18 01:26:54 [DEBUG] census_eda.main: [DEBUG-TS-MODEL] arima: forecasts={2024: 506434.720440129, 2025: 536506.2582994244, 2026: 566577.7961482117}, values=[506434.720440129, 536506.2582994244, 566577.7961482117], CI_lower=[365926.1433901808, 395997.6812494762, 426069.2190982635], CI_upper=[646943.2974900772, 677014.8353493726, 707086.37319816]
2025-12-18 01:26:54 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Forecast values: [506434.720440129, 536506.2582994244, 566577.7961482117], CI_lower: [365926.1433901808, 395997.6812494762, 426069.2190982635], CI_upper: [646943.2974900772, 677014.8353493726, 707086.37319816]
2025-12-18 01:26:54 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Plotted CI bands: lower=[np.float64(476363.18257032544), 365926.1433901808, 395997.6812494762, 426069.2190982635], upper=[np.float64(476363.18257032544), 646943.2974900772, 677014.8353493726, 707086.37319816]
2025-12-18 01:26:55 [DEBUG] census_eda.main: [DEBUG-TS-MODEL] holt_winters: forecasts={2024: 486321.36666428286, 2025: 516313.02953823906, 2026: 546304.6924121953}, values=[486321.36666428286, 516313.02953823906, 546304.6924121953], CI_lower=[384253.6033219177, 414245.2661958739, 444236.9290698301], CI_upper=[588389.130006648, 618380.7928806043, 648372.4557545604]
2025-12-18 01:26:55 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Forecast values: [486321.36666428286, 516313.02953823906, 546304.6924121953], CI_lower: [384253.6033219177, 414245.2661958739, 444236.9290698301], CI_upper: [588389.130006648, 618380.7928806043, 648372.4557545604]
2025-12-18 01:26:55 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Plotted CI bands: lower=[np.float64(476363.18257032544), 384253.6033219177, 414245.2661958739, 444236.9290698301], upper=[np.float64(476363.18257032544), 588389.130006648, 618380.7928806043, 648372.4557545604]
2025-12-18 01:26:56 [DEBUG] census_eda.main: [VIZ-TIMESERIES] Visualizing time series for target: Gross_Rent
2025-12-18 01:26:56 [DEBUG] census_eda.main: [DEBUG-TS-MODEL] polynomial_degree_1: forecasts={2024: 1053.7390018121077, 2025: 1081.6193179392067, 2026: 1109.4996340663056}, values=[1053.7390018121077, 1081.6193179392067, 1109.4996340663056], CI_lower=[955.5041372046239, 983.3844533317229, 1011.2647694588218], CI_upper=[1151.9738664195916, 1179.8541825466905, 1207.7344986737894]
2025-12-18 01:26:56 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Forecast values: [1053.7390018121077, 1081.6193179392067, 1109.4996340663056], CI_lower: [955.5041372046239, 983.3844533317229, 1011.2647694588218], CI_upper: [1151.9738664195916, 1179.8541825466905, 1207.7344986737894]
2025-12-18 01:26:56 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Plotted CI bands: lower=[np.float64(1152.5465587044534), 955.5041372046239, 983.3844533317229, 1011.2647694588218], upper=[np.float64(1152.5465587044534), 1151.9738664195916, 1179.8541825466905, 1207.7344986737894]
2025-12-18 01:26:56 [DEBUG] census_eda.main: [DEBUG-TS-MODEL] polynomial_degree_2: forecasts={2024: 1165.1744810985401, 2025: 1230.102263703011, 2026: 1298.9269230952486}, values=[1165.1744810985401, 1230.102263703011, 1298.9269230952486], CI_lower=[1114.3312645913552, 1179.259047195826, 1248.0837065880637], CI_upper=[1216.017697605725, 1280.945480210196, 1349.7701396024336]
2025-12-18 01:26:56 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Forecast values: [1165.1744810985401, 1230.102263703011, 1298.9269230952486], CI_lower: [1114.3312645913552, 1179.259047195826, 1248.0837065880637], CI_upper: [1216.017697605725, 1280.945480210196, 1349.7701396024336]
2025-12-18 01:26:56 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Plotted CI bands: lower=[np.float64(1152.5465587044534), 1114.3312645913552, 1179.259047195826, 1248.0837065880637], upper=[np.float64(1152.5465587044534), 1216.017697605725, 1280.945480210196, 1349.7701396024336]
2025-12-18 01:26:57 [DEBUG] census_eda.main: [DEBUG-TS-MODEL] polynomial_degree_3: forecasts={2024: 1236.6635591983795, 2025: 1351.5502216815948, 2026: 1483.5611078739166}, values=[1236.6635591983795, 1351.5502216815948, 1483.5611078739166], CI_lower=[1204.0627506745905, 1318.9494131578058, 1450.9602993501276], CI_upper=[1269.2643677221686, 1384.151030205384, 1516.1619163977057]
2025-12-18 01:26:57 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Forecast values: [1236.6635591983795, 1351.5502216815948, 1483.5611078739166], CI_lower: [1204.0627506745905, 1318.9494131578058, 1450.9602993501276], CI_upper: [1269.2643677221686, 1384.151030205384, 1516.1619163977057]
2025-12-18 01:26:57 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Plotted CI bands: lower=[np.float64(1152.5465587044534), 1204.0627506745905, 1318.9494131578058, 1450.9602993501276], upper=[np.float64(1152.5465587044534), 1269.2643677221686, 1384.151030205384, 1516.1619163977057]
2025-12-18 01:26:58 [DEBUG] census_eda.main: [DEBUG-TS-MODEL] sma: forecasts={2024: 1051.7824240346524, 2025: 1051.7824240346524, 2026: 1051.7824240346524}, values=[1051.7824240346524, 1051.7824240346524, 1051.7824240346524], CI_lower=[986.2683925091098, 986.2683925091098, 986.2683925091098], CI_upper=[1117.296455560195, 1117.296455560195, 1117.296455560195]
2025-12-18 01:26:58 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Forecast values: [1051.7824240346524, 1051.7824240346524, 1051.7824240346524], CI_lower: [986.2683925091098, 986.2683925091098, 986.2683925091098], CI_upper: [1117.296455560195, 1117.296455560195, 1117.296455560195]
2025-12-18 01:26:58 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Plotted CI bands: lower=[np.float64(1152.5465587044534), 986.2683925091098, 986.2683925091098, 986.2683925091098], upper=[np.float64(1152.5465587044534), 1117.296455560195, 1117.296455560195, 1117.296455560195]
2025-12-18 01:26:58 [DEBUG] census_eda.main: [DEBUG-TS-MODEL] ewma: forecasts={2024: 984.862640085026, 2025: 984.862640085026, 2026: 984.862640085026}, values=[984.862640085026, 984.862640085026, 984.862640085026], CI_lower=[897.3714021662522, 897.3714021662522, 897.3714021662522], CI_upper=[1072.3538780037998, 1072.3538780037998, 1072.3538780037998]
2025-12-18 01:26:58 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Forecast values: [984.862640085026, 984.862640085026, 984.862640085026], CI_lower: [897.3714021662522, 897.3714021662522, 897.3714021662522], CI_upper: [1072.3538780037998, 1072.3538780037998, 1072.3538780037998]
2025-12-18 01:26:58 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Plotted CI bands: lower=[np.float64(1152.5465587044534), 897.3714021662522, 897.3714021662522, 897.3714021662522], upper=[np.float64(1152.5465587044534), 1072.3538780037998, 1072.3538780037998, 1072.3538780037998]
2025-12-18 01:26:59 [DEBUG] census_eda.main: [DEBUG-TS-MODEL] wma: forecasts={2024: 1086.0481966392408, 2025: 1086.0481966392408, 2026: 1086.0481966392408}, values=[1086.0481966392408, 1086.0481966392408, 1086.0481966392408], CI_lower=[1036.893211899657, 1036.893211899657, 1036.893211899657], CI_upper=[1135.2031813788246, 1135.2031813788246, 1135.2031813788246]
2025-12-18 01:26:59 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Forecast values: [1086.0481966392408, 1086.0481966392408, 1086.0481966392408], CI_lower: [1036.893211899657, 1036.893211899657, 1036.893211899657], CI_upper: [1135.2031813788246, 1135.2031813788246, 1135.2031813788246]
2025-12-18 01:26:59 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Plotted CI bands: lower=[np.float64(1152.5465587044534), 1036.893211899657, 1036.893211899657, 1036.893211899657], upper=[np.float64(1152.5465587044534), 1135.2031813788246, 1135.2031813788246, 1135.2031813788246]
2025-12-18 01:27:00 [DEBUG] census_eda.main: [DEBUG-TS-MODEL] arima: forecasts={2024: 1240.0576803345498, 2025: 1321.1434516334446, 2026: 1396.2756426585845}, values=[1240.0576803345498, 1321.1434516334446, 1396.2756426585845], CI_lower=[945.9525717563738, 1027.0383430552686, 1102.1705340804085], CI_upper=[1534.1627889127258, 1615.2485602116205, 1690.3807512367605]
2025-12-18 01:27:00 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Forecast values: [1240.0576803345498, 1321.1434516334446, 1396.2756426585845], CI_lower: [945.9525717563738, 1027.0383430552686, 1102.1705340804085], CI_upper: [1534.1627889127258, 1615.2485602116205, 1690.3807512367605]
2025-12-18 01:27:00 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Plotted CI bands: lower=[np.float64(1152.5465587044534), 945.9525717563738, 1027.0383430552686, 1102.1705340804085], upper=[np.float64(1152.5465587044534), 1534.1627889127258, 1615.2485602116205, 1690.3807512367605]
2025-12-18 01:27:00 [DEBUG] census_eda.main: [DEBUG-TS-MODEL] holt_winters: forecasts={2024: 1247.745039071293, 2025: 1342.943519505524, 2026: 1438.141999939755}, values=[1247.745039071293, 1342.943519505524, 1438.141999939755], CI_lower=[1194.0250803347856, 1289.2235607690166, 1384.4220412032475], CI_upper=[1301.4649978078003, 1396.6634782420313, 1491.8619586762622]
2025-12-18 01:27:00 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Forecast values: [1247.745039071293, 1342.943519505524, 1438.141999939755], CI_lower: [1194.0250803347856, 1289.2235607690166, 1384.4220412032475], CI_upper: [1301.4649978078003, 1396.6634782420313, 1491.8619586762622]
2025-12-18 01:27:00 [DEBUG] census_eda.visualizations.ml.timeseries: [VIZ] Plotted CI bands: lower=[np.float64(1152.5465587044534), 1194.0250803347856, 1289.2235607690166, 1384.4220412032475], upper=[np.float64(1152.5465587044534), 1301.4649978078003, 1396.6634782420313, 1491.8619586762622]
2025-12-18 01:27:02 [INFO] census_eda.main: [DL] Running deep learning pipeline for HOUSING...
2025-12-18 01:27:02 [INFO] census_eda.main: [DL] Training property_valuation...
2025-12-18 01:27:28 [INFO] census_eda.main: [DL] ✓ property_valuation complete: multi_output, Test metrics: {'mae': 51302.859375, 'mse': 37910560768.0, 'rmse': 194706.34496081527, 'r2': -0.21359145641326904}
2025-12-18 01:27:29 [INFO] census_eda.main: [DL] Training affordability_analysis...
2025-12-18 01:27:48 [INFO] census_eda.main: [DL] ✓ affordability_analysis complete: multi_output, Test metrics: {'mae': 6.300753593444824, 'mse': 175.571533203125, 'rmse': 13.250340871204974, 'r2': 0.06049850583076477}
2025-12-18 01:27:49 [INFO] census_eda.main: [DL] Training housing_quality...
2025-12-18 01:28:08 [INFO] census_eda.main: [DL] ✓ housing_quality complete: multi_output, Test metrics: {'mae': 1.2513214349746704, 'mse': 20.94588279724121, 'rmse': 4.5766672150421, 'r2': 0.8501834869384766}
2025-12-18 01:28:08 [INFO] census_eda.main: [DL] Training cost_prediction...
2025-12-18 01:28:27 [INFO] census_eda.main: [DL] ✓ cost_prediction complete: multi_output, Test metrics: {'mae': 234.45858764648438, 'mse': 361993.34375, 'rmse': 601.658826703307, 'r2': 0.27263355255126953}
2025-12-18 01:28:28 [INFO] census_eda.main: [DL] Training occupancy_prediction...
2025-12-18 01:28:47 [INFO] census_eda.main: [DL] ✓ occupancy_prediction complete: multi_output, Test metrics: {'mae': 0.32398396730422974, 'mse': 0.40063872933387756, 'rmse': 0.6329602904873872, 'r2': 0.13665279746055603}
2025-12-18 01:28:48 [INFO] census_eda.main: [DL-VIZ] Creating visualizations for 5 tasks...
2025-12-18 01:29:03 [INFO] census_eda.main: [DL-VIZ] All visualizations saved to ./output/Montana/housing/1-year/figures/ml/deep_learning
2025-12-18 01:29:04 [DEBUG] census_eda.main: Starting LLM analysis with fallback handler...
2025-12-18 01:29:04 [DEBUG] census_eda.main: Initializing LLM client and analyzer...
2025-12-18 01:29:04 [DEBUG] census_eda.main:  Running LLM analysis for state: Montana
2025-12-18 01:29:04 [INFO] census_eda.ml: [LLM] Starting LLM analysis suite...
2025-12-18 01:29:04 [INFO] census_eda.ml: [LLM] State context loaded: Montana
2025-12-18 01:29:04 [INFO] census_eda.ml: [LLM] Running analysis: Temporal Trends
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [LLM] User prompt: 728 chars (~182 tokens)
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [PROMPT] Building system prompt...
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [PROMPT] Injecting state context for: Montana
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [CONTEXT] Loading context for state: Montana
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [CONTEXT] Formatted context length: 4243 chars
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [CONTEXT] Estimated tokens: ~1060
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [CONTEXT] Context preview:
2025-12-18 01:29:04 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:29:04 [DEBUG] census_eda.ml: 
STATE-SPECIFIC CONTEXT: Montana

ECONOMIC PROFILE:
  Industries: Agriculture (cattle, wheat), Mining (coal, copper, precious metals), Tourism and outdoor recreation, Healthcare, Energy (coal, oil, natural gas)
  Trends: Modest growth 2011-2023 driven by energy, agriculture, tourism. Remote work boom 2020-2023 brought population and housing surge. Extractive industries volatile. Tourism increasingly important
  Income: Below national median (~$60k) but cost of living historically lower (changing post-2020). Wage growth lagging housing costs. Significant wealth inequality - billionaire ranches vs. working poor
  Dominant Sector: Healthcare and social assistance

DEMOGRAPHIC PROFILE:
  Trends: Steady growth 2011-2019 (~0.8% annually), acceleration 2020-2023 from migration (~1.5% annually). Pandemic migration surge changed demographics
  Migration: Strong in-migration 2020-2023 from California, Washington, Texas (remote workers, retirees, lifestyle migration). Historically lost young people to metro areas. Native Americans significant portion of rural population
  Education: Near national average bachelor's degrees (~34%). Montana State, University of Montana anchors. Brain drain of graduates to larger metros persistent

HOUSING MARKET:
  Market: Formerly affordable, now crisis-level expensive in desirable areas. Bozeman median >$800k, Missoula >$500k (2023). Remote work migration drove prices. Rural still relatively affordable
  Affordability: Modest increases 2011-2019. Explosion 2020-2023 - worst housing inflation nationally. Wages not keeping pace. Local workers priced out
  Challenges: Worst housing affordability crisis nationally (recent), Local workers priced out, Short-term rental proliferation, Construction costs high, Limited buildable land in valleys, Seasonal workers housing crisis

POLITY:
  Policy: Conservative libertarian streak. Republican dominance but independent voters important. Environmental concerns cross party lines. Property rights sacred. Anti-federal government sentiment
  Housing: Limited state intervention historically. 2021-2023 crisis prompted action - developer incentives, local authority preservation debates. No rent control. Property tax caps contentious
  Labor: Federal minimum wage $7.25. Right-to-work state. Limited worker protections. Independent contractor economy in tourism

REGIONAL:
  Geography: Rocky Mountains (west), Great Plains (east). Continental Divide. Yellowstone, Glacier National Parks. Vast - 4th largest state by area
  Urban/Rural: 56% urban in few cities. 44% rural across vast landscape. Extremely low population density (4th lowest)
  Infrastructure: Sparse infrastructure. Long distances between towns. Aging highways. Broadband limited in rural areas. Airports in major cities. No major interstates east-west

HISTORICAL:
  Events: 2011-2013: Post-recession recovery slow, agriculture struggles, tourism growth; 2014-2016: Energy sector volatility, Medicaid expansion (2015), housing affordable; 2017-2019: Strong economy, tourism boom, housing prices start rising, wildfires increasing; 2020-2023: COVID migration boom, housing crisis, recreational marijuana (2020), unprecedented population growth, wildfire seasons severe, polarization increases
  Shocks: Coal industry decline long-term. Oil price volatility. 2020-2023 housing explosion. Wildfires affecting tourism and property
  Transitions: Coal mining declining. Renewable energy (wind) growing. Tourism eclipsing extractive industries. Remote work creating service economy. Agriculture consolidating

COMPARATIVE:
  Benchmarks: Below median income. Fastest housing cost increases 2020-2023. Low population density. High public land percentage (federal). Near average educational attainment. Healthcare access challenges in rural areas
  Peer States: Wyoming (extractive economy, low population), Idaho (growth, in-migration), North Dakota (rural, extractive)
  Unique: Largest population influx rate 2020-2023. Geography (mountains/plains) defines regions. Public lands dominance (30% federal). Native American reservations significant. Extractive industry legacy. Outdoor recreation economy. 'last best place' mystique driving migration. Housing crisis severity unique for rural state
2025-12-18 01:29:04 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [CONTEXT] Full context sections loaded:
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [CONTEXT]   ✓ STATE-SPECIFIC CONTEXT: Montana
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [CONTEXT]   ✓ ECONOMIC PROFILE:
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [CONTEXT]   ✓ DEMOGRAPHIC PROFILE:
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HOUSING MARKET:
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [CONTEXT]   ✓ POLITY:
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [CONTEXT]   ✓ REGIONAL:
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HISTORICAL:
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [CONTEXT]   ✓ COMPARATIVE:
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [PROMPT] State context injected (4243 chars)
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [PROMPT] Final system prompt: 9131 chars (~2282 tokens)
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [API] Total request: ~2464 tokens (system: ~2282, user: ~182)
2025-12-18 01:29:04 [DEBUG] census_eda.ml: [API] Sending request to http://localhost:11434/v1/chat/completions
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [API] Received response: 3191 chars
2025-12-18 01:29:14 [INFO] census_eda.ml: [LLM] Temporal Trends analysis complete (3191 chars)
2025-12-18 01:29:14 [INFO] census_eda.ml: [LLM] Running analysis: Data Quality
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [LLM] User prompt: 1262 chars (~315 tokens)
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [PROMPT] Building system prompt...
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [PROMPT] Injecting state context for: Montana
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [CONTEXT] Loading context for state: Montana
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [CONTEXT] Formatted context length: 4243 chars
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [CONTEXT] Estimated tokens: ~1060
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [CONTEXT] Context preview:
2025-12-18 01:29:14 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:29:14 [DEBUG] census_eda.ml: 
STATE-SPECIFIC CONTEXT: Montana

ECONOMIC PROFILE:
  Industries: Agriculture (cattle, wheat), Mining (coal, copper, precious metals), Tourism and outdoor recreation, Healthcare, Energy (coal, oil, natural gas)
  Trends: Modest growth 2011-2023 driven by energy, agriculture, tourism. Remote work boom 2020-2023 brought population and housing surge. Extractive industries volatile. Tourism increasingly important
  Income: Below national median (~$60k) but cost of living historically lower (changing post-2020). Wage growth lagging housing costs. Significant wealth inequality - billionaire ranches vs. working poor
  Dominant Sector: Healthcare and social assistance

DEMOGRAPHIC PROFILE:
  Trends: Steady growth 2011-2019 (~0.8% annually), acceleration 2020-2023 from migration (~1.5% annually). Pandemic migration surge changed demographics
  Migration: Strong in-migration 2020-2023 from California, Washington, Texas (remote workers, retirees, lifestyle migration). Historically lost young people to metro areas. Native Americans significant portion of rural population
  Education: Near national average bachelor's degrees (~34%). Montana State, University of Montana anchors. Brain drain of graduates to larger metros persistent

HOUSING MARKET:
  Market: Formerly affordable, now crisis-level expensive in desirable areas. Bozeman median >$800k, Missoula >$500k (2023). Remote work migration drove prices. Rural still relatively affordable
  Affordability: Modest increases 2011-2019. Explosion 2020-2023 - worst housing inflation nationally. Wages not keeping pace. Local workers priced out
  Challenges: Worst housing affordability crisis nationally (recent), Local workers priced out, Short-term rental proliferation, Construction costs high, Limited buildable land in valleys, Seasonal workers housing crisis

POLITY:
  Policy: Conservative libertarian streak. Republican dominance but independent voters important. Environmental concerns cross party lines. Property rights sacred. Anti-federal government sentiment
  Housing: Limited state intervention historically. 2021-2023 crisis prompted action - developer incentives, local authority preservation debates. No rent control. Property tax caps contentious
  Labor: Federal minimum wage $7.25. Right-to-work state. Limited worker protections. Independent contractor economy in tourism

REGIONAL:
  Geography: Rocky Mountains (west), Great Plains (east). Continental Divide. Yellowstone, Glacier National Parks. Vast - 4th largest state by area
  Urban/Rural: 56% urban in few cities. 44% rural across vast landscape. Extremely low population density (4th lowest)
  Infrastructure: Sparse infrastructure. Long distances between towns. Aging highways. Broadband limited in rural areas. Airports in major cities. No major interstates east-west

HISTORICAL:
  Events: 2011-2013: Post-recession recovery slow, agriculture struggles, tourism growth; 2014-2016: Energy sector volatility, Medicaid expansion (2015), housing affordable; 2017-2019: Strong economy, tourism boom, housing prices start rising, wildfires increasing; 2020-2023: COVID migration boom, housing crisis, recreational marijuana (2020), unprecedented population growth, wildfire seasons severe, polarization increases
  Shocks: Coal industry decline long-term. Oil price volatility. 2020-2023 housing explosion. Wildfires affecting tourism and property
  Transitions: Coal mining declining. Renewable energy (wind) growing. Tourism eclipsing extractive industries. Remote work creating service economy. Agriculture consolidating

COMPARATIVE:
  Benchmarks: Below median income. Fastest housing cost increases 2020-2023. Low population density. High public land percentage (federal). Near average educational attainment. Healthcare access challenges in rural areas
  Peer States: Wyoming (extractive economy, low population), Idaho (growth, in-migration), North Dakota (rural, extractive)
  Unique: Largest population influx rate 2020-2023. Geography (mountains/plains) defines regions. Public lands dominance (30% federal). Native American reservations significant. Extractive industry legacy. Outdoor recreation economy. 'last best place' mystique driving migration. Housing crisis severity unique for rural state
2025-12-18 01:29:14 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [CONTEXT] Full context sections loaded:
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [CONTEXT]   ✓ STATE-SPECIFIC CONTEXT: Montana
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [CONTEXT]   ✓ ECONOMIC PROFILE:
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [CONTEXT]   ✓ DEMOGRAPHIC PROFILE:
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HOUSING MARKET:
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [CONTEXT]   ✓ POLITY:
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [CONTEXT]   ✓ REGIONAL:
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HISTORICAL:
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [CONTEXT]   ✓ COMPARATIVE:
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [PROMPT] State context injected (4243 chars)
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [PROMPT] Final system prompt: 9131 chars (~2282 tokens)
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [API] Total request: ~2597 tokens (system: ~2282, user: ~315)
2025-12-18 01:29:14 [DEBUG] census_eda.ml: [API] Sending request to http://localhost:11434/v1/chat/completions
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [API] Received response: 3592 chars
2025-12-18 01:29:24 [INFO] census_eda.ml: [LLM] Data Quality analysis complete (3592 chars)
2025-12-18 01:29:24 [INFO] census_eda.ml: [LLM] Running analysis: Research Recommendations
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [LLM] User prompt: 1689 chars (~422 tokens)
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [PROMPT] Building system prompt...
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [PROMPT] Injecting state context for: Montana
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [CONTEXT] Loading context for state: Montana
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [CONTEXT] Formatted context length: 4243 chars
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [CONTEXT] Estimated tokens: ~1060
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [CONTEXT] Context preview:
2025-12-18 01:29:24 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:29:24 [DEBUG] census_eda.ml: 
STATE-SPECIFIC CONTEXT: Montana

ECONOMIC PROFILE:
  Industries: Agriculture (cattle, wheat), Mining (coal, copper, precious metals), Tourism and outdoor recreation, Healthcare, Energy (coal, oil, natural gas)
  Trends: Modest growth 2011-2023 driven by energy, agriculture, tourism. Remote work boom 2020-2023 brought population and housing surge. Extractive industries volatile. Tourism increasingly important
  Income: Below national median (~$60k) but cost of living historically lower (changing post-2020). Wage growth lagging housing costs. Significant wealth inequality - billionaire ranches vs. working poor
  Dominant Sector: Healthcare and social assistance

DEMOGRAPHIC PROFILE:
  Trends: Steady growth 2011-2019 (~0.8% annually), acceleration 2020-2023 from migration (~1.5% annually). Pandemic migration surge changed demographics
  Migration: Strong in-migration 2020-2023 from California, Washington, Texas (remote workers, retirees, lifestyle migration). Historically lost young people to metro areas. Native Americans significant portion of rural population
  Education: Near national average bachelor's degrees (~34%). Montana State, University of Montana anchors. Brain drain of graduates to larger metros persistent

HOUSING MARKET:
  Market: Formerly affordable, now crisis-level expensive in desirable areas. Bozeman median >$800k, Missoula >$500k (2023). Remote work migration drove prices. Rural still relatively affordable
  Affordability: Modest increases 2011-2019. Explosion 2020-2023 - worst housing inflation nationally. Wages not keeping pace. Local workers priced out
  Challenges: Worst housing affordability crisis nationally (recent), Local workers priced out, Short-term rental proliferation, Construction costs high, Limited buildable land in valleys, Seasonal workers housing crisis

POLITY:
  Policy: Conservative libertarian streak. Republican dominance but independent voters important. Environmental concerns cross party lines. Property rights sacred. Anti-federal government sentiment
  Housing: Limited state intervention historically. 2021-2023 crisis prompted action - developer incentives, local authority preservation debates. No rent control. Property tax caps contentious
  Labor: Federal minimum wage $7.25. Right-to-work state. Limited worker protections. Independent contractor economy in tourism

REGIONAL:
  Geography: Rocky Mountains (west), Great Plains (east). Continental Divide. Yellowstone, Glacier National Parks. Vast - 4th largest state by area
  Urban/Rural: 56% urban in few cities. 44% rural across vast landscape. Extremely low population density (4th lowest)
  Infrastructure: Sparse infrastructure. Long distances between towns. Aging highways. Broadband limited in rural areas. Airports in major cities. No major interstates east-west

HISTORICAL:
  Events: 2011-2013: Post-recession recovery slow, agriculture struggles, tourism growth; 2014-2016: Energy sector volatility, Medicaid expansion (2015), housing affordable; 2017-2019: Strong economy, tourism boom, housing prices start rising, wildfires increasing; 2020-2023: COVID migration boom, housing crisis, recreational marijuana (2020), unprecedented population growth, wildfire seasons severe, polarization increases
  Shocks: Coal industry decline long-term. Oil price volatility. 2020-2023 housing explosion. Wildfires affecting tourism and property
  Transitions: Coal mining declining. Renewable energy (wind) growing. Tourism eclipsing extractive industries. Remote work creating service economy. Agriculture consolidating

COMPARATIVE:
  Benchmarks: Below median income. Fastest housing cost increases 2020-2023. Low population density. High public land percentage (federal). Near average educational attainment. Healthcare access challenges in rural areas
  Peer States: Wyoming (extractive economy, low population), Idaho (growth, in-migration), North Dakota (rural, extractive)
  Unique: Largest population influx rate 2020-2023. Geography (mountains/plains) defines regions. Public lands dominance (30% federal). Native American reservations significant. Extractive industry legacy. Outdoor recreation economy. 'last best place' mystique driving migration. Housing crisis severity unique for rural state
2025-12-18 01:29:24 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [CONTEXT] Full context sections loaded:
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [CONTEXT]   ✓ STATE-SPECIFIC CONTEXT: Montana
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [CONTEXT]   ✓ ECONOMIC PROFILE:
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [CONTEXT]   ✓ DEMOGRAPHIC PROFILE:
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HOUSING MARKET:
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [CONTEXT]   ✓ POLITY:
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [CONTEXT]   ✓ REGIONAL:
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HISTORICAL:
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [CONTEXT]   ✓ COMPARATIVE:
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [PROMPT] State context injected (4243 chars)
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [PROMPT] Final system prompt: 9131 chars (~2282 tokens)
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [API] Total request: ~2704 tokens (system: ~2282, user: ~422)
2025-12-18 01:29:24 [DEBUG] census_eda.ml: [API] Sending request to http://localhost:11434/v1/chat/completions
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [API] Received response: 4256 chars
2025-12-18 01:29:36 [INFO] census_eda.ml: [LLM] Research Recommendations analysis complete (4256 chars)
2025-12-18 01:29:36 [INFO] census_eda.ml: [LLM] Running analysis: Economic Analysis
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [LLM] User prompt: 1464 chars (~366 tokens)
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [PROMPT] Building system prompt...
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [PROMPT] Injecting state context for: Montana
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [CONTEXT] Loading context for state: Montana
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [CONTEXT] Formatted context length: 4243 chars
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [CONTEXT] Estimated tokens: ~1060
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [CONTEXT] Context preview:
2025-12-18 01:29:36 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:29:36 [DEBUG] census_eda.ml: 
STATE-SPECIFIC CONTEXT: Montana

ECONOMIC PROFILE:
  Industries: Agriculture (cattle, wheat), Mining (coal, copper, precious metals), Tourism and outdoor recreation, Healthcare, Energy (coal, oil, natural gas)
  Trends: Modest growth 2011-2023 driven by energy, agriculture, tourism. Remote work boom 2020-2023 brought population and housing surge. Extractive industries volatile. Tourism increasingly important
  Income: Below national median (~$60k) but cost of living historically lower (changing post-2020). Wage growth lagging housing costs. Significant wealth inequality - billionaire ranches vs. working poor
  Dominant Sector: Healthcare and social assistance

DEMOGRAPHIC PROFILE:
  Trends: Steady growth 2011-2019 (~0.8% annually), acceleration 2020-2023 from migration (~1.5% annually). Pandemic migration surge changed demographics
  Migration: Strong in-migration 2020-2023 from California, Washington, Texas (remote workers, retirees, lifestyle migration). Historically lost young people to metro areas. Native Americans significant portion of rural population
  Education: Near national average bachelor's degrees (~34%). Montana State, University of Montana anchors. Brain drain of graduates to larger metros persistent

HOUSING MARKET:
  Market: Formerly affordable, now crisis-level expensive in desirable areas. Bozeman median >$800k, Missoula >$500k (2023). Remote work migration drove prices. Rural still relatively affordable
  Affordability: Modest increases 2011-2019. Explosion 2020-2023 - worst housing inflation nationally. Wages not keeping pace. Local workers priced out
  Challenges: Worst housing affordability crisis nationally (recent), Local workers priced out, Short-term rental proliferation, Construction costs high, Limited buildable land in valleys, Seasonal workers housing crisis

POLITY:
  Policy: Conservative libertarian streak. Republican dominance but independent voters important. Environmental concerns cross party lines. Property rights sacred. Anti-federal government sentiment
  Housing: Limited state intervention historically. 2021-2023 crisis prompted action - developer incentives, local authority preservation debates. No rent control. Property tax caps contentious
  Labor: Federal minimum wage $7.25. Right-to-work state. Limited worker protections. Independent contractor economy in tourism

REGIONAL:
  Geography: Rocky Mountains (west), Great Plains (east). Continental Divide. Yellowstone, Glacier National Parks. Vast - 4th largest state by area
  Urban/Rural: 56% urban in few cities. 44% rural across vast landscape. Extremely low population density (4th lowest)
  Infrastructure: Sparse infrastructure. Long distances between towns. Aging highways. Broadband limited in rural areas. Airports in major cities. No major interstates east-west

HISTORICAL:
  Events: 2011-2013: Post-recession recovery slow, agriculture struggles, tourism growth; 2014-2016: Energy sector volatility, Medicaid expansion (2015), housing affordable; 2017-2019: Strong economy, tourism boom, housing prices start rising, wildfires increasing; 2020-2023: COVID migration boom, housing crisis, recreational marijuana (2020), unprecedented population growth, wildfire seasons severe, polarization increases
  Shocks: Coal industry decline long-term. Oil price volatility. 2020-2023 housing explosion. Wildfires affecting tourism and property
  Transitions: Coal mining declining. Renewable energy (wind) growing. Tourism eclipsing extractive industries. Remote work creating service economy. Agriculture consolidating

COMPARATIVE:
  Benchmarks: Below median income. Fastest housing cost increases 2020-2023. Low population density. High public land percentage (federal). Near average educational attainment. Healthcare access challenges in rural areas
  Peer States: Wyoming (extractive economy, low population), Idaho (growth, in-migration), North Dakota (rural, extractive)
  Unique: Largest population influx rate 2020-2023. Geography (mountains/plains) defines regions. Public lands dominance (30% federal). Native American reservations significant. Extractive industry legacy. Outdoor recreation economy. 'last best place' mystique driving migration. Housing crisis severity unique for rural state
2025-12-18 01:29:36 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [CONTEXT] Full context sections loaded:
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [CONTEXT]   ✓ STATE-SPECIFIC CONTEXT: Montana
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [CONTEXT]   ✓ ECONOMIC PROFILE:
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [CONTEXT]   ✓ DEMOGRAPHIC PROFILE:
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HOUSING MARKET:
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [CONTEXT]   ✓ POLITY:
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [CONTEXT]   ✓ REGIONAL:
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HISTORICAL:
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [CONTEXT]   ✓ COMPARATIVE:
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [PROMPT] State context injected (4243 chars)
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [PROMPT] Final system prompt: 9131 chars (~2282 tokens)
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [API] Total request: ~2648 tokens (system: ~2282, user: ~366)
2025-12-18 01:29:36 [DEBUG] census_eda.ml: [API] Sending request to http://localhost:11434/v1/chat/completions
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [API] Received response: 5959 chars
2025-12-18 01:29:54 [INFO] census_eda.ml: [LLM] Economic Analysis analysis complete (5959 chars)
2025-12-18 01:29:54 [INFO] census_eda.ml: [LLM] Running analysis: Correlation Analysis
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [LLM] User prompt: 47 chars (~11 tokens)
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [PROMPT] Building system prompt...
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [PROMPT] Injecting state context for: Montana
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [CONTEXT] Loading context for state: Montana
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [CONTEXT] Formatted context length: 4243 chars
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [CONTEXT] Estimated tokens: ~1060
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [CONTEXT] Context preview:
2025-12-18 01:29:54 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:29:54 [DEBUG] census_eda.ml: 
STATE-SPECIFIC CONTEXT: Montana

ECONOMIC PROFILE:
  Industries: Agriculture (cattle, wheat), Mining (coal, copper, precious metals), Tourism and outdoor recreation, Healthcare, Energy (coal, oil, natural gas)
  Trends: Modest growth 2011-2023 driven by energy, agriculture, tourism. Remote work boom 2020-2023 brought population and housing surge. Extractive industries volatile. Tourism increasingly important
  Income: Below national median (~$60k) but cost of living historically lower (changing post-2020). Wage growth lagging housing costs. Significant wealth inequality - billionaire ranches vs. working poor
  Dominant Sector: Healthcare and social assistance

DEMOGRAPHIC PROFILE:
  Trends: Steady growth 2011-2019 (~0.8% annually), acceleration 2020-2023 from migration (~1.5% annually). Pandemic migration surge changed demographics
  Migration: Strong in-migration 2020-2023 from California, Washington, Texas (remote workers, retirees, lifestyle migration). Historically lost young people to metro areas. Native Americans significant portion of rural population
  Education: Near national average bachelor's degrees (~34%). Montana State, University of Montana anchors. Brain drain of graduates to larger metros persistent

HOUSING MARKET:
  Market: Formerly affordable, now crisis-level expensive in desirable areas. Bozeman median >$800k, Missoula >$500k (2023). Remote work migration drove prices. Rural still relatively affordable
  Affordability: Modest increases 2011-2019. Explosion 2020-2023 - worst housing inflation nationally. Wages not keeping pace. Local workers priced out
  Challenges: Worst housing affordability crisis nationally (recent), Local workers priced out, Short-term rental proliferation, Construction costs high, Limited buildable land in valleys, Seasonal workers housing crisis

POLITY:
  Policy: Conservative libertarian streak. Republican dominance but independent voters important. Environmental concerns cross party lines. Property rights sacred. Anti-federal government sentiment
  Housing: Limited state intervention historically. 2021-2023 crisis prompted action - developer incentives, local authority preservation debates. No rent control. Property tax caps contentious
  Labor: Federal minimum wage $7.25. Right-to-work state. Limited worker protections. Independent contractor economy in tourism

REGIONAL:
  Geography: Rocky Mountains (west), Great Plains (east). Continental Divide. Yellowstone, Glacier National Parks. Vast - 4th largest state by area
  Urban/Rural: 56% urban in few cities. 44% rural across vast landscape. Extremely low population density (4th lowest)
  Infrastructure: Sparse infrastructure. Long distances between towns. Aging highways. Broadband limited in rural areas. Airports in major cities. No major interstates east-west

HISTORICAL:
  Events: 2011-2013: Post-recession recovery slow, agriculture struggles, tourism growth; 2014-2016: Energy sector volatility, Medicaid expansion (2015), housing affordable; 2017-2019: Strong economy, tourism boom, housing prices start rising, wildfires increasing; 2020-2023: COVID migration boom, housing crisis, recreational marijuana (2020), unprecedented population growth, wildfire seasons severe, polarization increases
  Shocks: Coal industry decline long-term. Oil price volatility. 2020-2023 housing explosion. Wildfires affecting tourism and property
  Transitions: Coal mining declining. Renewable energy (wind) growing. Tourism eclipsing extractive industries. Remote work creating service economy. Agriculture consolidating

COMPARATIVE:
  Benchmarks: Below median income. Fastest housing cost increases 2020-2023. Low population density. High public land percentage (federal). Near average educational attainment. Healthcare access challenges in rural areas
  Peer States: Wyoming (extractive economy, low population), Idaho (growth, in-migration), North Dakota (rural, extractive)
  Unique: Largest population influx rate 2020-2023. Geography (mountains/plains) defines regions. Public lands dominance (30% federal). Native American reservations significant. Extractive industry legacy. Outdoor recreation economy. 'last best place' mystique driving migration. Housing crisis severity unique for rural state
2025-12-18 01:29:54 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [CONTEXT] Full context sections loaded:
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [CONTEXT]   ✓ STATE-SPECIFIC CONTEXT: Montana
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [CONTEXT]   ✓ ECONOMIC PROFILE:
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [CONTEXT]   ✓ DEMOGRAPHIC PROFILE:
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HOUSING MARKET:
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [CONTEXT]   ✓ POLITY:
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [CONTEXT]   ✓ REGIONAL:
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HISTORICAL:
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [CONTEXT]   ✓ COMPARATIVE:
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [PROMPT] State context injected (4243 chars)
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [PROMPT] Final system prompt: 9131 chars (~2282 tokens)
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [API] Total request: ~2293 tokens (system: ~2282, user: ~11)
2025-12-18 01:29:54 [DEBUG] census_eda.ml: [API] Sending request to http://localhost:11434/v1/chat/completions
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [API] Received response: 5885 chars
2025-12-18 01:30:12 [INFO] census_eda.ml: [LLM] Correlation Analysis analysis complete (5885 chars)
2025-12-18 01:30:12 [INFO] census_eda.ml: [LLM] Running analysis: Statistical Analysis
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [LLM] User prompt: 11263 chars (~2815 tokens)
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [PROMPT] Building system prompt...
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [PROMPT] Injecting state context for: Montana
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [CONTEXT] Loading context for state: Montana
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [CONTEXT] Formatted context length: 4243 chars
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [CONTEXT] Estimated tokens: ~1060
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [CONTEXT] Context preview:
2025-12-18 01:30:12 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:30:12 [DEBUG] census_eda.ml: 
STATE-SPECIFIC CONTEXT: Montana

ECONOMIC PROFILE:
  Industries: Agriculture (cattle, wheat), Mining (coal, copper, precious metals), Tourism and outdoor recreation, Healthcare, Energy (coal, oil, natural gas)
  Trends: Modest growth 2011-2023 driven by energy, agriculture, tourism. Remote work boom 2020-2023 brought population and housing surge. Extractive industries volatile. Tourism increasingly important
  Income: Below national median (~$60k) but cost of living historically lower (changing post-2020). Wage growth lagging housing costs. Significant wealth inequality - billionaire ranches vs. working poor
  Dominant Sector: Healthcare and social assistance

DEMOGRAPHIC PROFILE:
  Trends: Steady growth 2011-2019 (~0.8% annually), acceleration 2020-2023 from migration (~1.5% annually). Pandemic migration surge changed demographics
  Migration: Strong in-migration 2020-2023 from California, Washington, Texas (remote workers, retirees, lifestyle migration). Historically lost young people to metro areas. Native Americans significant portion of rural population
  Education: Near national average bachelor's degrees (~34%). Montana State, University of Montana anchors. Brain drain of graduates to larger metros persistent

HOUSING MARKET:
  Market: Formerly affordable, now crisis-level expensive in desirable areas. Bozeman median >$800k, Missoula >$500k (2023). Remote work migration drove prices. Rural still relatively affordable
  Affordability: Modest increases 2011-2019. Explosion 2020-2023 - worst housing inflation nationally. Wages not keeping pace. Local workers priced out
  Challenges: Worst housing affordability crisis nationally (recent), Local workers priced out, Short-term rental proliferation, Construction costs high, Limited buildable land in valleys, Seasonal workers housing crisis

POLITY:
  Policy: Conservative libertarian streak. Republican dominance but independent voters important. Environmental concerns cross party lines. Property rights sacred. Anti-federal government sentiment
  Housing: Limited state intervention historically. 2021-2023 crisis prompted action - developer incentives, local authority preservation debates. No rent control. Property tax caps contentious
  Labor: Federal minimum wage $7.25. Right-to-work state. Limited worker protections. Independent contractor economy in tourism

REGIONAL:
  Geography: Rocky Mountains (west), Great Plains (east). Continental Divide. Yellowstone, Glacier National Parks. Vast - 4th largest state by area
  Urban/Rural: 56% urban in few cities. 44% rural across vast landscape. Extremely low population density (4th lowest)
  Infrastructure: Sparse infrastructure. Long distances between towns. Aging highways. Broadband limited in rural areas. Airports in major cities. No major interstates east-west

HISTORICAL:
  Events: 2011-2013: Post-recession recovery slow, agriculture struggles, tourism growth; 2014-2016: Energy sector volatility, Medicaid expansion (2015), housing affordable; 2017-2019: Strong economy, tourism boom, housing prices start rising, wildfires increasing; 2020-2023: COVID migration boom, housing crisis, recreational marijuana (2020), unprecedented population growth, wildfire seasons severe, polarization increases
  Shocks: Coal industry decline long-term. Oil price volatility. 2020-2023 housing explosion. Wildfires affecting tourism and property
  Transitions: Coal mining declining. Renewable energy (wind) growing. Tourism eclipsing extractive industries. Remote work creating service economy. Agriculture consolidating

COMPARATIVE:
  Benchmarks: Below median income. Fastest housing cost increases 2020-2023. Low population density. High public land percentage (federal). Near average educational attainment. Healthcare access challenges in rural areas
  Peer States: Wyoming (extractive economy, low population), Idaho (growth, in-migration), North Dakota (rural, extractive)
  Unique: Largest population influx rate 2020-2023. Geography (mountains/plains) defines regions. Public lands dominance (30% federal). Native American reservations significant. Extractive industry legacy. Outdoor recreation economy. 'last best place' mystique driving migration. Housing crisis severity unique for rural state
2025-12-18 01:30:12 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [CONTEXT] Full context sections loaded:
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [CONTEXT]   ✓ STATE-SPECIFIC CONTEXT: Montana
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [CONTEXT]   ✓ ECONOMIC PROFILE:
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [CONTEXT]   ✓ DEMOGRAPHIC PROFILE:
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HOUSING MARKET:
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [CONTEXT]   ✓ POLITY:
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [CONTEXT]   ✓ REGIONAL:
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HISTORICAL:
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [CONTEXT]   ✓ COMPARATIVE:
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [PROMPT] State context injected (4243 chars)
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [PROMPT] Final system prompt: 9131 chars (~2282 tokens)
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [API] Total request: ~5097 tokens (system: ~2282, user: ~2815)
2025-12-18 01:30:12 [DEBUG] census_eda.ml: [API] Sending request to http://localhost:11434/v1/chat/completions
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [API] Received response: 3125 chars
2025-12-18 01:30:23 [INFO] census_eda.ml: [LLM] Statistical Analysis analysis complete (3125 chars)
2025-12-18 01:30:23 [INFO] census_eda.ml: [LLM] Running analysis: Outlier Detection
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [LLM] User prompt: 6866 chars (~1716 tokens)
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [PROMPT] Building system prompt...
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [PROMPT] Injecting state context for: Montana
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [CONTEXT] Loading context for state: Montana
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [CONTEXT] Formatted context length: 4243 chars
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [CONTEXT] Estimated tokens: ~1060
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [CONTEXT] Context preview:
2025-12-18 01:30:23 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:30:23 [DEBUG] census_eda.ml: 
STATE-SPECIFIC CONTEXT: Montana

ECONOMIC PROFILE:
  Industries: Agriculture (cattle, wheat), Mining (coal, copper, precious metals), Tourism and outdoor recreation, Healthcare, Energy (coal, oil, natural gas)
  Trends: Modest growth 2011-2023 driven by energy, agriculture, tourism. Remote work boom 2020-2023 brought population and housing surge. Extractive industries volatile. Tourism increasingly important
  Income: Below national median (~$60k) but cost of living historically lower (changing post-2020). Wage growth lagging housing costs. Significant wealth inequality - billionaire ranches vs. working poor
  Dominant Sector: Healthcare and social assistance

DEMOGRAPHIC PROFILE:
  Trends: Steady growth 2011-2019 (~0.8% annually), acceleration 2020-2023 from migration (~1.5% annually). Pandemic migration surge changed demographics
  Migration: Strong in-migration 2020-2023 from California, Washington, Texas (remote workers, retirees, lifestyle migration). Historically lost young people to metro areas. Native Americans significant portion of rural population
  Education: Near national average bachelor's degrees (~34%). Montana State, University of Montana anchors. Brain drain of graduates to larger metros persistent

HOUSING MARKET:
  Market: Formerly affordable, now crisis-level expensive in desirable areas. Bozeman median >$800k, Missoula >$500k (2023). Remote work migration drove prices. Rural still relatively affordable
  Affordability: Modest increases 2011-2019. Explosion 2020-2023 - worst housing inflation nationally. Wages not keeping pace. Local workers priced out
  Challenges: Worst housing affordability crisis nationally (recent), Local workers priced out, Short-term rental proliferation, Construction costs high, Limited buildable land in valleys, Seasonal workers housing crisis

POLITY:
  Policy: Conservative libertarian streak. Republican dominance but independent voters important. Environmental concerns cross party lines. Property rights sacred. Anti-federal government sentiment
  Housing: Limited state intervention historically. 2021-2023 crisis prompted action - developer incentives, local authority preservation debates. No rent control. Property tax caps contentious
  Labor: Federal minimum wage $7.25. Right-to-work state. Limited worker protections. Independent contractor economy in tourism

REGIONAL:
  Geography: Rocky Mountains (west), Great Plains (east). Continental Divide. Yellowstone, Glacier National Parks. Vast - 4th largest state by area
  Urban/Rural: 56% urban in few cities. 44% rural across vast landscape. Extremely low population density (4th lowest)
  Infrastructure: Sparse infrastructure. Long distances between towns. Aging highways. Broadband limited in rural areas. Airports in major cities. No major interstates east-west

HISTORICAL:
  Events: 2011-2013: Post-recession recovery slow, agriculture struggles, tourism growth; 2014-2016: Energy sector volatility, Medicaid expansion (2015), housing affordable; 2017-2019: Strong economy, tourism boom, housing prices start rising, wildfires increasing; 2020-2023: COVID migration boom, housing crisis, recreational marijuana (2020), unprecedented population growth, wildfire seasons severe, polarization increases
  Shocks: Coal industry decline long-term. Oil price volatility. 2020-2023 housing explosion. Wildfires affecting tourism and property
  Transitions: Coal mining declining. Renewable energy (wind) growing. Tourism eclipsing extractive industries. Remote work creating service economy. Agriculture consolidating

COMPARATIVE:
  Benchmarks: Below median income. Fastest housing cost increases 2020-2023. Low population density. High public land percentage (federal). Near average educational attainment. Healthcare access challenges in rural areas
  Peer States: Wyoming (extractive economy, low population), Idaho (growth, in-migration), North Dakota (rural, extractive)
  Unique: Largest population influx rate 2020-2023. Geography (mountains/plains) defines regions. Public lands dominance (30% federal). Native American reservations significant. Extractive industry legacy. Outdoor recreation economy. 'last best place' mystique driving migration. Housing crisis severity unique for rural state
2025-12-18 01:30:23 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [CONTEXT] Full context sections loaded:
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [CONTEXT]   ✓ STATE-SPECIFIC CONTEXT: Montana
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [CONTEXT]   ✓ ECONOMIC PROFILE:
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [CONTEXT]   ✓ DEMOGRAPHIC PROFILE:
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HOUSING MARKET:
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [CONTEXT]   ✓ POLITY:
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [CONTEXT]   ✓ REGIONAL:
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HISTORICAL:
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [CONTEXT]   ✓ COMPARATIVE:
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [PROMPT] State context injected (4243 chars)
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [PROMPT] Final system prompt: 9131 chars (~2282 tokens)
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [API] Total request: ~3998 tokens (system: ~2282, user: ~1716)
2025-12-18 01:30:23 [DEBUG] census_eda.ml: [API] Sending request to http://localhost:11434/v1/chat/completions
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [API] Received response: 2781 chars
2025-12-18 01:30:32 [INFO] census_eda.ml: [LLM] Outlier Detection analysis complete (2781 chars)
2025-12-18 01:30:32 [INFO] census_eda.ml: [LLM] Running analysis: Anomaly Detection
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [LLM] User prompt: 610 chars (~152 tokens)
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [PROMPT] Building system prompt...
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [PROMPT] Injecting state context for: Montana
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [CONTEXT] Loading context for state: Montana
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [CONTEXT] Formatted context length: 4243 chars
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [CONTEXT] Estimated tokens: ~1060
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [CONTEXT] Context preview:
2025-12-18 01:30:32 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:30:32 [DEBUG] census_eda.ml: 
STATE-SPECIFIC CONTEXT: Montana

ECONOMIC PROFILE:
  Industries: Agriculture (cattle, wheat), Mining (coal, copper, precious metals), Tourism and outdoor recreation, Healthcare, Energy (coal, oil, natural gas)
  Trends: Modest growth 2011-2023 driven by energy, agriculture, tourism. Remote work boom 2020-2023 brought population and housing surge. Extractive industries volatile. Tourism increasingly important
  Income: Below national median (~$60k) but cost of living historically lower (changing post-2020). Wage growth lagging housing costs. Significant wealth inequality - billionaire ranches vs. working poor
  Dominant Sector: Healthcare and social assistance

DEMOGRAPHIC PROFILE:
  Trends: Steady growth 2011-2019 (~0.8% annually), acceleration 2020-2023 from migration (~1.5% annually). Pandemic migration surge changed demographics
  Migration: Strong in-migration 2020-2023 from California, Washington, Texas (remote workers, retirees, lifestyle migration). Historically lost young people to metro areas. Native Americans significant portion of rural population
  Education: Near national average bachelor's degrees (~34%). Montana State, University of Montana anchors. Brain drain of graduates to larger metros persistent

HOUSING MARKET:
  Market: Formerly affordable, now crisis-level expensive in desirable areas. Bozeman median >$800k, Missoula >$500k (2023). Remote work migration drove prices. Rural still relatively affordable
  Affordability: Modest increases 2011-2019. Explosion 2020-2023 - worst housing inflation nationally. Wages not keeping pace. Local workers priced out
  Challenges: Worst housing affordability crisis nationally (recent), Local workers priced out, Short-term rental proliferation, Construction costs high, Limited buildable land in valleys, Seasonal workers housing crisis

POLITY:
  Policy: Conservative libertarian streak. Republican dominance but independent voters important. Environmental concerns cross party lines. Property rights sacred. Anti-federal government sentiment
  Housing: Limited state intervention historically. 2021-2023 crisis prompted action - developer incentives, local authority preservation debates. No rent control. Property tax caps contentious
  Labor: Federal minimum wage $7.25. Right-to-work state. Limited worker protections. Independent contractor economy in tourism

REGIONAL:
  Geography: Rocky Mountains (west), Great Plains (east). Continental Divide. Yellowstone, Glacier National Parks. Vast - 4th largest state by area
  Urban/Rural: 56% urban in few cities. 44% rural across vast landscape. Extremely low population density (4th lowest)
  Infrastructure: Sparse infrastructure. Long distances between towns. Aging highways. Broadband limited in rural areas. Airports in major cities. No major interstates east-west

HISTORICAL:
  Events: 2011-2013: Post-recession recovery slow, agriculture struggles, tourism growth; 2014-2016: Energy sector volatility, Medicaid expansion (2015), housing affordable; 2017-2019: Strong economy, tourism boom, housing prices start rising, wildfires increasing; 2020-2023: COVID migration boom, housing crisis, recreational marijuana (2020), unprecedented population growth, wildfire seasons severe, polarization increases
  Shocks: Coal industry decline long-term. Oil price volatility. 2020-2023 housing explosion. Wildfires affecting tourism and property
  Transitions: Coal mining declining. Renewable energy (wind) growing. Tourism eclipsing extractive industries. Remote work creating service economy. Agriculture consolidating

COMPARATIVE:
  Benchmarks: Below median income. Fastest housing cost increases 2020-2023. Low population density. High public land percentage (federal). Near average educational attainment. Healthcare access challenges in rural areas
  Peer States: Wyoming (extractive economy, low population), Idaho (growth, in-migration), North Dakota (rural, extractive)
  Unique: Largest population influx rate 2020-2023. Geography (mountains/plains) defines regions. Public lands dominance (30% federal). Native American reservations significant. Extractive industry legacy. Outdoor recreation economy. 'last best place' mystique driving migration. Housing crisis severity unique for rural state
2025-12-18 01:30:32 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [CONTEXT] Full context sections loaded:
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [CONTEXT]   ✓ STATE-SPECIFIC CONTEXT: Montana
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [CONTEXT]   ✓ ECONOMIC PROFILE:
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [CONTEXT]   ✓ DEMOGRAPHIC PROFILE:
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HOUSING MARKET:
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [CONTEXT]   ✓ POLITY:
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [CONTEXT]   ✓ REGIONAL:
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HISTORICAL:
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [CONTEXT]   ✓ COMPARATIVE:
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [PROMPT] State context injected (4243 chars)
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [PROMPT] Final system prompt: 9131 chars (~2282 tokens)
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [API] Total request: ~2434 tokens (system: ~2282, user: ~152)
2025-12-18 01:30:32 [DEBUG] census_eda.ml: [API] Sending request to http://localhost:11434/v1/chat/completions
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [API] Received response: 4479 chars
2025-12-18 01:30:46 [INFO] census_eda.ml: [LLM] Anomaly Detection analysis complete (4479 chars)
2025-12-18 01:30:46 [INFO] census_eda.ml: [LLM] Running analysis: Trend Analysis
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [LLM] User prompt: 6397 chars (~1599 tokens)
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [PROMPT] Building system prompt...
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [PROMPT] Injecting state context for: Montana
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [CONTEXT] Loading context for state: Montana
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [CONTEXT] Formatted context length: 4243 chars
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [CONTEXT] Estimated tokens: ~1060
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [CONTEXT] Context preview:
2025-12-18 01:30:46 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:30:46 [DEBUG] census_eda.ml: 
STATE-SPECIFIC CONTEXT: Montana

ECONOMIC PROFILE:
  Industries: Agriculture (cattle, wheat), Mining (coal, copper, precious metals), Tourism and outdoor recreation, Healthcare, Energy (coal, oil, natural gas)
  Trends: Modest growth 2011-2023 driven by energy, agriculture, tourism. Remote work boom 2020-2023 brought population and housing surge. Extractive industries volatile. Tourism increasingly important
  Income: Below national median (~$60k) but cost of living historically lower (changing post-2020). Wage growth lagging housing costs. Significant wealth inequality - billionaire ranches vs. working poor
  Dominant Sector: Healthcare and social assistance

DEMOGRAPHIC PROFILE:
  Trends: Steady growth 2011-2019 (~0.8% annually), acceleration 2020-2023 from migration (~1.5% annually). Pandemic migration surge changed demographics
  Migration: Strong in-migration 2020-2023 from California, Washington, Texas (remote workers, retirees, lifestyle migration). Historically lost young people to metro areas. Native Americans significant portion of rural population
  Education: Near national average bachelor's degrees (~34%). Montana State, University of Montana anchors. Brain drain of graduates to larger metros persistent

HOUSING MARKET:
  Market: Formerly affordable, now crisis-level expensive in desirable areas. Bozeman median >$800k, Missoula >$500k (2023). Remote work migration drove prices. Rural still relatively affordable
  Affordability: Modest increases 2011-2019. Explosion 2020-2023 - worst housing inflation nationally. Wages not keeping pace. Local workers priced out
  Challenges: Worst housing affordability crisis nationally (recent), Local workers priced out, Short-term rental proliferation, Construction costs high, Limited buildable land in valleys, Seasonal workers housing crisis

POLITY:
  Policy: Conservative libertarian streak. Republican dominance but independent voters important. Environmental concerns cross party lines. Property rights sacred. Anti-federal government sentiment
  Housing: Limited state intervention historically. 2021-2023 crisis prompted action - developer incentives, local authority preservation debates. No rent control. Property tax caps contentious
  Labor: Federal minimum wage $7.25. Right-to-work state. Limited worker protections. Independent contractor economy in tourism

REGIONAL:
  Geography: Rocky Mountains (west), Great Plains (east). Continental Divide. Yellowstone, Glacier National Parks. Vast - 4th largest state by area
  Urban/Rural: 56% urban in few cities. 44% rural across vast landscape. Extremely low population density (4th lowest)
  Infrastructure: Sparse infrastructure. Long distances between towns. Aging highways. Broadband limited in rural areas. Airports in major cities. No major interstates east-west

HISTORICAL:
  Events: 2011-2013: Post-recession recovery slow, agriculture struggles, tourism growth; 2014-2016: Energy sector volatility, Medicaid expansion (2015), housing affordable; 2017-2019: Strong economy, tourism boom, housing prices start rising, wildfires increasing; 2020-2023: COVID migration boom, housing crisis, recreational marijuana (2020), unprecedented population growth, wildfire seasons severe, polarization increases
  Shocks: Coal industry decline long-term. Oil price volatility. 2020-2023 housing explosion. Wildfires affecting tourism and property
  Transitions: Coal mining declining. Renewable energy (wind) growing. Tourism eclipsing extractive industries. Remote work creating service economy. Agriculture consolidating

COMPARATIVE:
  Benchmarks: Below median income. Fastest housing cost increases 2020-2023. Low population density. High public land percentage (federal). Near average educational attainment. Healthcare access challenges in rural areas
  Peer States: Wyoming (extractive economy, low population), Idaho (growth, in-migration), North Dakota (rural, extractive)
  Unique: Largest population influx rate 2020-2023. Geography (mountains/plains) defines regions. Public lands dominance (30% federal). Native American reservations significant. Extractive industry legacy. Outdoor recreation economy. 'last best place' mystique driving migration. Housing crisis severity unique for rural state
2025-12-18 01:30:46 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [CONTEXT] Full context sections loaded:
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [CONTEXT]   ✓ STATE-SPECIFIC CONTEXT: Montana
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [CONTEXT]   ✓ ECONOMIC PROFILE:
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [CONTEXT]   ✓ DEMOGRAPHIC PROFILE:
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HOUSING MARKET:
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [CONTEXT]   ✓ POLITY:
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [CONTEXT]   ✓ REGIONAL:
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HISTORICAL:
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [CONTEXT]   ✓ COMPARATIVE:
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [PROMPT] State context injected (4243 chars)
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [PROMPT] Final system prompt: 9131 chars (~2282 tokens)
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [API] Total request: ~3881 tokens (system: ~2282, user: ~1599)
2025-12-18 01:30:46 [DEBUG] census_eda.ml: [API] Sending request to http://localhost:11434/v1/chat/completions
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [API] Received response: 3558 chars
2025-12-18 01:30:57 [INFO] census_eda.ml: [LLM] Trend Analysis analysis complete (3558 chars)
2025-12-18 01:30:57 [INFO] census_eda.ml: [LLM] Running analysis: Deep Learning Analysis
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [LLM] User prompt: 2517 chars (~629 tokens)
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [PROMPT] Building system prompt...
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [PROMPT] Injecting state context for: Montana
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [CONTEXT] Loading context for state: Montana
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [CONTEXT] Formatted context length: 4243 chars
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [CONTEXT] Estimated tokens: ~1060
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [CONTEXT] Context preview:
2025-12-18 01:30:57 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:30:57 [DEBUG] census_eda.ml: 
STATE-SPECIFIC CONTEXT: Montana

ECONOMIC PROFILE:
  Industries: Agriculture (cattle, wheat), Mining (coal, copper, precious metals), Tourism and outdoor recreation, Healthcare, Energy (coal, oil, natural gas)
  Trends: Modest growth 2011-2023 driven by energy, agriculture, tourism. Remote work boom 2020-2023 brought population and housing surge. Extractive industries volatile. Tourism increasingly important
  Income: Below national median (~$60k) but cost of living historically lower (changing post-2020). Wage growth lagging housing costs. Significant wealth inequality - billionaire ranches vs. working poor
  Dominant Sector: Healthcare and social assistance

DEMOGRAPHIC PROFILE:
  Trends: Steady growth 2011-2019 (~0.8% annually), acceleration 2020-2023 from migration (~1.5% annually). Pandemic migration surge changed demographics
  Migration: Strong in-migration 2020-2023 from California, Washington, Texas (remote workers, retirees, lifestyle migration). Historically lost young people to metro areas. Native Americans significant portion of rural population
  Education: Near national average bachelor's degrees (~34%). Montana State, University of Montana anchors. Brain drain of graduates to larger metros persistent

HOUSING MARKET:
  Market: Formerly affordable, now crisis-level expensive in desirable areas. Bozeman median >$800k, Missoula >$500k (2023). Remote work migration drove prices. Rural still relatively affordable
  Affordability: Modest increases 2011-2019. Explosion 2020-2023 - worst housing inflation nationally. Wages not keeping pace. Local workers priced out
  Challenges: Worst housing affordability crisis nationally (recent), Local workers priced out, Short-term rental proliferation, Construction costs high, Limited buildable land in valleys, Seasonal workers housing crisis

POLITY:
  Policy: Conservative libertarian streak. Republican dominance but independent voters important. Environmental concerns cross party lines. Property rights sacred. Anti-federal government sentiment
  Housing: Limited state intervention historically. 2021-2023 crisis prompted action - developer incentives, local authority preservation debates. No rent control. Property tax caps contentious
  Labor: Federal minimum wage $7.25. Right-to-work state. Limited worker protections. Independent contractor economy in tourism

REGIONAL:
  Geography: Rocky Mountains (west), Great Plains (east). Continental Divide. Yellowstone, Glacier National Parks. Vast - 4th largest state by area
  Urban/Rural: 56% urban in few cities. 44% rural across vast landscape. Extremely low population density (4th lowest)
  Infrastructure: Sparse infrastructure. Long distances between towns. Aging highways. Broadband limited in rural areas. Airports in major cities. No major interstates east-west

HISTORICAL:
  Events: 2011-2013: Post-recession recovery slow, agriculture struggles, tourism growth; 2014-2016: Energy sector volatility, Medicaid expansion (2015), housing affordable; 2017-2019: Strong economy, tourism boom, housing prices start rising, wildfires increasing; 2020-2023: COVID migration boom, housing crisis, recreational marijuana (2020), unprecedented population growth, wildfire seasons severe, polarization increases
  Shocks: Coal industry decline long-term. Oil price volatility. 2020-2023 housing explosion. Wildfires affecting tourism and property
  Transitions: Coal mining declining. Renewable energy (wind) growing. Tourism eclipsing extractive industries. Remote work creating service economy. Agriculture consolidating

COMPARATIVE:
  Benchmarks: Below median income. Fastest housing cost increases 2020-2023. Low population density. High public land percentage (federal). Near average educational attainment. Healthcare access challenges in rural areas
  Peer States: Wyoming (extractive economy, low population), Idaho (growth, in-migration), North Dakota (rural, extractive)
  Unique: Largest population influx rate 2020-2023. Geography (mountains/plains) defines regions. Public lands dominance (30% federal). Native American reservations significant. Extractive industry legacy. Outdoor recreation economy. 'last best place' mystique driving migration. Housing crisis severity unique for rural state
2025-12-18 01:30:57 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [CONTEXT] Full context sections loaded:
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [CONTEXT]   ✓ STATE-SPECIFIC CONTEXT: Montana
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [CONTEXT]   ✓ ECONOMIC PROFILE:
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [CONTEXT]   ✓ DEMOGRAPHIC PROFILE:
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HOUSING MARKET:
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [CONTEXT]   ✓ POLITY:
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [CONTEXT]   ✓ REGIONAL:
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HISTORICAL:
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [CONTEXT]   ✓ COMPARATIVE:
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [PROMPT] State context injected (4243 chars)
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [PROMPT] Final system prompt: 9131 chars (~2282 tokens)
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [API] Total request: ~2911 tokens (system: ~2282, user: ~629)
2025-12-18 01:30:57 [DEBUG] census_eda.ml: [API] Sending request to http://localhost:11434/v1/chat/completions
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [API] Received response: 3536 chars
2025-12-18 01:31:09 [INFO] census_eda.ml: [LLM] Deep Learning Analysis analysis complete (3536 chars)
2025-12-18 01:31:09 [INFO] census_eda.ml: [LLM] Running analysis: Feature Engineering
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [LLM] User prompt: 1046 chars (~261 tokens)
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [PROMPT] Building system prompt...
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [PROMPT] Injecting state context for: Montana
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [CONTEXT] Loading context for state: Montana
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [CONTEXT] Formatted context length: 4243 chars
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [CONTEXT] Estimated tokens: ~1060
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [CONTEXT] Context preview:
2025-12-18 01:31:09 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:31:09 [DEBUG] census_eda.ml: 
STATE-SPECIFIC CONTEXT: Montana

ECONOMIC PROFILE:
  Industries: Agriculture (cattle, wheat), Mining (coal, copper, precious metals), Tourism and outdoor recreation, Healthcare, Energy (coal, oil, natural gas)
  Trends: Modest growth 2011-2023 driven by energy, agriculture, tourism. Remote work boom 2020-2023 brought population and housing surge. Extractive industries volatile. Tourism increasingly important
  Income: Below national median (~$60k) but cost of living historically lower (changing post-2020). Wage growth lagging housing costs. Significant wealth inequality - billionaire ranches vs. working poor
  Dominant Sector: Healthcare and social assistance

DEMOGRAPHIC PROFILE:
  Trends: Steady growth 2011-2019 (~0.8% annually), acceleration 2020-2023 from migration (~1.5% annually). Pandemic migration surge changed demographics
  Migration: Strong in-migration 2020-2023 from California, Washington, Texas (remote workers, retirees, lifestyle migration). Historically lost young people to metro areas. Native Americans significant portion of rural population
  Education: Near national average bachelor's degrees (~34%). Montana State, University of Montana anchors. Brain drain of graduates to larger metros persistent

HOUSING MARKET:
  Market: Formerly affordable, now crisis-level expensive in desirable areas. Bozeman median >$800k, Missoula >$500k (2023). Remote work migration drove prices. Rural still relatively affordable
  Affordability: Modest increases 2011-2019. Explosion 2020-2023 - worst housing inflation nationally. Wages not keeping pace. Local workers priced out
  Challenges: Worst housing affordability crisis nationally (recent), Local workers priced out, Short-term rental proliferation, Construction costs high, Limited buildable land in valleys, Seasonal workers housing crisis

POLITY:
  Policy: Conservative libertarian streak. Republican dominance but independent voters important. Environmental concerns cross party lines. Property rights sacred. Anti-federal government sentiment
  Housing: Limited state intervention historically. 2021-2023 crisis prompted action - developer incentives, local authority preservation debates. No rent control. Property tax caps contentious
  Labor: Federal minimum wage $7.25. Right-to-work state. Limited worker protections. Independent contractor economy in tourism

REGIONAL:
  Geography: Rocky Mountains (west), Great Plains (east). Continental Divide. Yellowstone, Glacier National Parks. Vast - 4th largest state by area
  Urban/Rural: 56% urban in few cities. 44% rural across vast landscape. Extremely low population density (4th lowest)
  Infrastructure: Sparse infrastructure. Long distances between towns. Aging highways. Broadband limited in rural areas. Airports in major cities. No major interstates east-west

HISTORICAL:
  Events: 2011-2013: Post-recession recovery slow, agriculture struggles, tourism growth; 2014-2016: Energy sector volatility, Medicaid expansion (2015), housing affordable; 2017-2019: Strong economy, tourism boom, housing prices start rising, wildfires increasing; 2020-2023: COVID migration boom, housing crisis, recreational marijuana (2020), unprecedented population growth, wildfire seasons severe, polarization increases
  Shocks: Coal industry decline long-term. Oil price volatility. 2020-2023 housing explosion. Wildfires affecting tourism and property
  Transitions: Coal mining declining. Renewable energy (wind) growing. Tourism eclipsing extractive industries. Remote work creating service economy. Agriculture consolidating

COMPARATIVE:
  Benchmarks: Below median income. Fastest housing cost increases 2020-2023. Low population density. High public land percentage (federal). Near average educational attainment. Healthcare access challenges in rural areas
  Peer States: Wyoming (extractive economy, low population), Idaho (growth, in-migration), North Dakota (rural, extractive)
  Unique: Largest population influx rate 2020-2023. Geography (mountains/plains) defines regions. Public lands dominance (30% federal). Native American reservations significant. Extractive industry legacy. Outdoor recreation economy. 'last best place' mystique driving migration. Housing crisis severity unique for rural state
2025-12-18 01:31:09 [DEBUG] census_eda.ml: ----------------------------------------------------------------------
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [CONTEXT] Full context sections loaded:
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [CONTEXT]   ✓ STATE-SPECIFIC CONTEXT: Montana
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [CONTEXT]   ✓ ECONOMIC PROFILE:
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [CONTEXT]   ✓ DEMOGRAPHIC PROFILE:
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HOUSING MARKET:
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [CONTEXT]   ✓ POLITY:
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [CONTEXT]   ✓ REGIONAL:
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [CONTEXT]   ✓ HISTORICAL:
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [CONTEXT]   ✓ COMPARATIVE:
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [PROMPT] State context injected (4243 chars)
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [PROMPT] Final system prompt: 9131 chars (~2282 tokens)
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [API] Total request: ~2543 tokens (system: ~2282, user: ~261)
2025-12-18 01:31:09 [DEBUG] census_eda.ml: [API] Sending request to http://localhost:11434/v1/chat/completions
2025-12-18 01:31:29 [DEBUG] census_eda.ml: [API] Received response: 7058 chars
2025-12-18 01:31:29 [INFO] census_eda.ml: [LLM] Feature Engineering analysis complete (7058 chars)
2025-12-18 01:31:29 [INFO] census_eda.ml: [LLM] LLM analysis suite complete: 11/11 analyses succeeded
2025-12-18 01:31:29 [DEBUG] census_eda.main: LLM analysis completed successfully
2025-12-18 01:31:29 [INFO] census_eda.main: [REPORT] Generated: report_Montana_housing_20251218_013129.txt
2025-12-18 01:31:29 [INFO] census_eda.main: SUCCESS: HOUSING (1-year) pipeline complete for Montana!
2025-12-18 01:31:30 [INFO] census_eda.memory: process_Montana_housing_1-year:EXIT: 8890.6MB (delta: -5042.8MB)
2025-12-18 01:31:31 [DEBUG] census_eda.memory: Cleared matplotlib caches
2025-12-18 01:31:31 [DEBUG] census_eda.memory: Reset seaborn defaults
2025-12-18 01:31:32 [DEBUG] census_eda.memory: Cleared TensorFlow session
2025-12-18 01:31:33 [INFO] census_eda.memory: Cleared all caches
